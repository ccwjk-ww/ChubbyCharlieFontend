import{a as G}from"./chunk-WBJKIWZC.js";import{a as K}from"./chunk-7AEJN7K3.js";import{b as Y}from"./chunk-36LRLGSZ.js";import{b as T,d as k,e as N,f as W,g as B,h as F,i as L,n as q,o as z,p as j,r as R,s as U,u as H}from"./chunk-32P7OPYT.js";import{b as I,d as V}from"./chunk-ACYYDNGN.js";import"./chunk-ZATVBB7N.js";import{Bb as d,Cb as y,Db as w,Gb as p,Ha as a,Hb as g,Ib as _,La as v,Ra as P,Wa as x,Z as s,_ as l,fc as S,gc as A,hb as E,ib as o,jb as u,jc as D,kb as f,qb as M,rb as h,tb as c}from"./chunk-45HGJHZR.js";function Q(m,n){if(m&1){let e=M();o(0,"button",66),h("click",function(){s(e);let t=c().index,r=c(2);return l(r.removeOrderItem(t))}),f(1,"i",67),u()}}function X(m,n){if(m&1&&(o(0,"span",73),d(1),u()),m&2){let e=c().$implicit;a(),w("SKU: ",e.sku)}}function Z(m,n){if(m&1){let e=M();o(0,"div",70),h("mousedown",function(){let t=s(e).$implicit,r=c(2).index,b=c(2);return l(b.selectProduct(r,t))}),o(1,"span",71),d(2),u(),x(3,X,2,1,"span",72),u()}if(m&2){let e=n.$implicit;a(2),y(e.productName),a(),E("ngIf",e.sku)}}function $(m,n){if(m&1&&(o(0,"div",68),x(1,Z,4,2,"div",69),u()),m&2){let e=c(3);a(),E("ngForOf",e.filteredProducts.slice(0,5))}}function ee(m,n){if(m&1){let e=M();o(0,"div",50)(1,"div",51)(2,"span",52),d(3),u(),x(4,Q,2,0,"button",53),u(),o(5,"div",54)(6,"div",55)(7,"div",56)(8,"label",15),d(9,"\u0E0A\u0E37\u0E48\u0E2D\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32"),u(),o(10,"input",57),_("ngModelChange",function(t){let r=s(e).$implicit;return g(r.productName,t)||(r.productName=t),l(t)}),h("input",function(){let t=s(e),r=t.$implicit,b=t.index,C=c(2);return l(C.onProductSearch(b,r.productName))})("blur",function(){let t=s(e).index,r=c(2);return l(r.hideSuggestions(t))}),u(),x(11,$,2,1,"div",58),u(),o(12,"div",59)(13,"label"),d(14,"SKU"),u(),o(15,"input",60),_("ngModelChange",function(t){let r=s(e).$implicit;return g(r.productSku,t)||(r.productSku=t),l(t)}),u()()(),o(16,"div",55)(17,"div",12)(18,"label",15),d(19,"\u0E08\u0E33\u0E19\u0E27\u0E19"),u(),o(20,"input",61),_("ngModelChange",function(t){let r=s(e).$implicit;return g(r.quantity,t)||(r.quantity=t),l(t)}),h("input",function(){let t=s(e).index,r=c(2);return l(r.calculateItemTotal(t))}),u()(),o(21,"div",12)(22,"label",15),d(23,"\u0E23\u0E32\u0E04\u0E32/\u0E2B\u0E19\u0E48\u0E27\u0E22"),u(),o(24,"input",62),_("ngModelChange",function(t){let r=s(e).$implicit;return g(r.unitPrice,t)||(r.unitPrice=t),l(t)}),h("input",function(){let t=s(e).index,r=c(2);return l(r.calculateItemTotal(t))}),u()(),o(25,"div",12)(26,"label"),d(27,"\u0E2A\u0E48\u0E27\u0E19\u0E25\u0E14"),u(),o(28,"input",63),_("ngModelChange",function(t){let r=s(e).$implicit;return g(r.discount,t)||(r.discount=t),l(t)}),h("input",function(){let t=s(e).index,r=c(2);return l(r.calculateItemTotal(t))}),u()(),o(29,"div",12)(30,"label"),d(31,"\u0E22\u0E2D\u0E14\u0E23\u0E27\u0E21"),u(),f(32,"input",64),u()(),o(33,"div",55)(34,"div",23)(35,"label"),d(36,"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38"),u(),o(37,"input",65),_("ngModelChange",function(t){let r=s(e).$implicit;return g(r.notes,t)||(r.notes=t),l(t)}),u()()()()()}if(m&2){let e=n.$implicit,i=n.index,t=c(2);a(3),w("\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E17\u0E35\u0E48 ",i+1),a(),E("ngIf",t.orderItems.length>1),a(6),p("ngModel",e.productName),E("name","productName_"+i),a(),E("ngIf",t.showSuggestions[i]&&t.filteredProducts.length>0),a(4),p("ngModel",e.productSku),E("name","productSku_"+i),a(5),p("ngModel",e.quantity),E("name","quantity_"+i),a(4),p("ngModel",e.unitPrice),E("name","unitPrice_"+i),a(4),p("ngModel",e.discount),E("name","discount_"+i),a(4),E("value",t.formatCurrency(e.totalPrice)),a(5),p("ngModel",e.notes),E("name","itemNotes_"+i)}}function te(m,n){m&1&&f(0,"div",74)}function ne(m,n){m&1&&f(0,"i",75)}function ie(m,n){if(m&1){let e=M();o(0,"div",2)(1,"div",3)(2,"button",4),h("click",function(){s(e);let t=c();return l(t.goBack())}),f(3,"i",5),d(4," \u0E01\u0E25\u0E31\u0E1A "),u(),o(5,"h1"),d(6),u(),o(7,"p",6),d(8,"\u0E01\u0E23\u0E2D\u0E01\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E41\u0E25\u0E30\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32"),u()(),o(9,"form",7),h("ngSubmit",function(){s(e);let t=c();return l(t.onSubmit())}),o(10,"div",8)(11,"div",9),f(12,"i",10),o(13,"h2"),d(14,"\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C"),u()(),o(15,"div",11)(16,"div",12)(17,"label"),d(18,"\u0E40\u0E25\u0E02\u0E17\u0E35\u0E48\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C"),u(),o(19,"input",13),_("ngModelChange",function(t){s(e);let r=c();return g(r.orderNumber,t)||(r.orderNumber=t),l(t)}),u(),o(20,"small",14),d(21,"\u0E2B\u0E32\u0E01\u0E1B\u0E25\u0E48\u0E2D\u0E22\u0E27\u0E48\u0E32\u0E07 \u0E23\u0E30\u0E1A\u0E1A\u0E08\u0E30\u0E2A\u0E23\u0E49\u0E32\u0E07\u0E40\u0E25\u0E02\u0E17\u0E35\u0E48\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34"),u()(),o(22,"div",12)(23,"label",15),d(24,"\u0E41\u0E2B\u0E25\u0E48\u0E07\u0E17\u0E35\u0E48\u0E21\u0E32"),u(),o(25,"select",16),_("ngModelChange",function(t){s(e);let r=c();return g(r.source,t)||(r.source=t),l(t)}),o(26,"option",17),d(27,"Manual"),u(),o(28,"option",18),d(29,"24Shop"),u(),o(30,"option",19),d(31,"Shopee"),u()()(),o(32,"div",12)(33,"label",15),d(34,"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E2A\u0E31\u0E48\u0E07"),u(),o(35,"input",20),_("ngModelChange",function(t){s(e);let r=c();return g(r.orderDate,t)||(r.orderDate=t),l(t)}),u()(),o(36,"div",12)(37,"label"),d(38,"\u0E27\u0E31\u0E19\u0E17\u0E35\u0E48\u0E2A\u0E48\u0E07"),u(),o(39,"input",21),_("ngModelChange",function(t){s(e);let r=c();return g(r.deliveryDate,t)||(r.deliveryDate=t),l(t)}),u()()()(),o(40,"div",8)(41,"div",9),f(42,"i",22),o(43,"h2"),d(44,"\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32"),u()(),o(45,"div",11)(46,"div",23)(47,"label",15),d(48,"\u0E0A\u0E37\u0E48\u0E2D\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32"),u(),o(49,"input",24),_("ngModelChange",function(t){s(e);let r=c();return g(r.customerName,t)||(r.customerName=t),l(t)}),u()(),o(50,"div",12)(51,"label"),d(52,"\u0E40\u0E1A\u0E2D\u0E23\u0E4C\u0E42\u0E17\u0E23\u0E28\u0E31\u0E1E\u0E17\u0E4C"),u(),o(53,"input",25),_("ngModelChange",function(t){s(e);let r=c();return g(r.customerPhone,t)||(r.customerPhone=t),l(t)}),u()(),o(54,"div",23)(55,"label"),d(56,"\u0E17\u0E35\u0E48\u0E2D\u0E22\u0E39\u0E48\u0E08\u0E31\u0E14\u0E2A\u0E48\u0E07"),u(),o(57,"textarea",26),_("ngModelChange",function(t){s(e);let r=c();return g(r.shippingAddress,t)||(r.shippingAddress=t),l(t)}),u()()()(),o(58,"div",8)(59,"div",9),f(60,"i",27),o(61,"h2"),d(62,"\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32"),u(),o(63,"button",28),h("click",function(){s(e);let t=c();return l(t.addOrderItem())}),f(64,"i",29),d(65," \u0E40\u0E1E\u0E34\u0E48\u0E21\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23 "),u()(),o(66,"div",30),x(67,ee,38,16,"div",31),u()(),o(68,"div",8)(69,"div",9),f(70,"i",32),o(71,"h2"),d(72,"\u0E2A\u0E23\u0E38\u0E1B\u0E22\u0E2D\u0E14\u0E0A\u0E33\u0E23\u0E30"),u()(),o(73,"div",33)(74,"div",34)(75,"div",12)(76,"label"),d(77,"\u0E04\u0E48\u0E32\u0E08\u0E31\u0E14\u0E2A\u0E48\u0E07"),u(),o(78,"input",35),_("ngModelChange",function(t){s(e);let r=c();return g(r.shippingFee,t)||(r.shippingFee=t),l(t)}),h("input",function(){s(e);let t=c();return l(t.calculateTotals())}),u()(),o(79,"div",12)(80,"label"),d(81,"\u0E2A\u0E48\u0E27\u0E19\u0E25\u0E14\u0E17\u0E31\u0E49\u0E07\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C"),u(),o(82,"input",36),_("ngModelChange",function(t){s(e);let r=c();return g(r.discount,t)||(r.discount=t),l(t)}),h("input",function(){s(e);let t=c();return l(t.calculateTotals())}),u()(),o(83,"div",23)(84,"label"),d(85,"\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38"),u(),o(86,"textarea",37),_("ngModelChange",function(t){s(e);let r=c();return g(r.notes,t)||(r.notes=t),l(t)}),u()()(),o(87,"div",38)(88,"div",39)(89,"span",40),d(90,"\u0E22\u0E2D\u0E14\u0E23\u0E27\u0E21\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32:"),u(),o(91,"span",41),d(92),u()(),o(93,"div",39)(94,"span",40),d(95,"\u0E04\u0E48\u0E32\u0E08\u0E31\u0E14\u0E2A\u0E48\u0E07:"),u(),o(96,"span",41),d(97),u()(),o(98,"div",39)(99,"span",40),d(100,"\u0E2A\u0E48\u0E27\u0E19\u0E25\u0E14:"),u(),o(101,"span",42),d(102),u()(),o(103,"div",43)(104,"span",40),d(105,"\u0E22\u0E2D\u0E14\u0E2A\u0E38\u0E17\u0E18\u0E34:"),u(),o(106,"span",41),d(107),u()()()()(),o(108,"div",44)(109,"button",45),h("click",function(){s(e);let t=c();return l(t.goBack())}),f(110,"i",46),d(111," \u0E22\u0E01\u0E40\u0E25\u0E34\u0E01 "),u(),o(112,"button",47),x(113,te,1,0,"div",48)(114,ne,1,0,"i",49),d(115),u()()()()}if(m&2){let e=c();a(6),y(e.isEditMode?"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C":"\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E43\u0E2B\u0E21\u0E48"),a(13),p("ngModel",e.orderNumber),a(6),p("ngModel",e.source),a(10),p("ngModel",e.orderDate),a(4),p("ngModel",e.deliveryDate),a(10),p("ngModel",e.customerName),a(4),p("ngModel",e.customerPhone),a(4),p("ngModel",e.shippingAddress),a(10),E("ngForOf",e.orderItems),a(11),p("ngModel",e.shippingFee),a(4),p("ngModel",e.discount),a(4),p("ngModel",e.notes),a(6),y(e.formatCurrency(e.subtotal)),a(5),y(e.formatCurrency(e.shippingFee)),a(5),w("-",e.formatCurrency(e.discount)),a(5),y(e.formatCurrency(e.netAmount)),a(5),E("disabled",e.submitting),a(),E("ngIf",e.submitting),a(),E("ngIf",!e.submitting),a(),w(" ",e.submitting?"\u0E01\u0E33\u0E25\u0E31\u0E07\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01...":e.isEditMode?"\u0E1A\u0E31\u0E19\u0E17\u0E36\u0E01\u0E01\u0E32\u0E23\u0E41\u0E01\u0E49\u0E44\u0E02":"\u0E2A\u0E23\u0E49\u0E32\u0E07\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C"," ")}}function re(m,n){m&1&&(o(0,"div",76),f(1,"div",74),o(2,"p"),d(3,"\u0E01\u0E33\u0E25\u0E31\u0E07\u0E42\u0E2B\u0E25\u0E14\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25..."),u()())}var J=class m{constructor(n,e,i,t,r){this.orderService=n;this.productService=e;this.transactionService=i;this.router=t;this.route=r}isEditMode=!1;orderId=null;loading=!1;submitting=!1;orderNumber="";source="MANUAL";customerName="";customerPhone="";shippingAddress="";orderDate="";deliveryDate="";shippingFee=0;discount=0;notes="";orderItems=[];products=[];filteredProducts=[];showSuggestions=[];subtotal=0;netAmount=0;ngOnInit(){this.initializeOrderDate(),this.addOrderItem(),this.loadProducts();let n=this.route.snapshot.paramMap.get("id");n&&(this.isEditMode=!0,this.orderId=Number(n),this.loadOrder())}initializeOrderDate(){let n=new Date;this.orderDate=this.formatDateForInput(n)}formatDateForInput(n){let e=n.getFullYear(),i=String(n.getMonth()+1).padStart(2,"0"),t=String(n.getDate()).padStart(2,"0"),r=String(n.getHours()).padStart(2,"0"),b=String(n.getMinutes()).padStart(2,"0");return`${e}-${i}-${t}T${r}:${b}`}loadProducts(){this.productService.getAllProducts().subscribe({next:n=>{this.products=n,this.filteredProducts=n},error:n=>console.error("Error loading products:",n)})}loadOrder(){this.orderId&&(this.loading=!0,this.orderService.getOrderById(this.orderId).subscribe({next:n=>{this.populateFormWithOrder(n),this.loading=!1},error:n=>{console.error("Error loading order:",n),alert("\u0E44\u0E21\u0E48\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E42\u0E2B\u0E25\u0E14\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E44\u0E14\u0E49"),this.router.navigate(["/orders"])}}))}populateFormWithOrder(n){this.orderNumber=n.orderNumber,this.source=n.source||"MANUAL",this.customerName=n.customerName||"",this.customerPhone=n.customerPhone||"",this.shippingAddress=n.shippingAddress||"",this.orderDate=n.orderDate?this.formatDateForInput(new Date(n.orderDate)):"",this.deliveryDate=n.deliveryDate?this.formatDateForInput(new Date(n.deliveryDate)):"",this.shippingFee=n.shippingFee||0,this.discount=n.discount||0,this.notes=n.notes||"",this.orderItems=[],n.orderItems&&n.orderItems.length>0?n.orderItems.forEach(e=>{this.orderItems.push({productId:e.productId,productName:e.productName,productSku:e.productSku||"",quantity:e.quantity,unitPrice:e.unitPrice,discount:e.discount||0,totalPrice:e.totalPrice||0,notes:e.notes||""}),this.showSuggestions.push(!1)}):this.addOrderItem(),this.calculateTotals()}addOrderItem(){this.orderItems.push({productName:"",productSku:"",quantity:1,unitPrice:0,discount:0,totalPrice:0,notes:""}),this.showSuggestions.push(!1)}removeOrderItem(n){this.orderItems.length>1?(this.orderItems.splice(n,1),this.showSuggestions.splice(n,1),this.calculateTotals()):alert("\u0E15\u0E49\u0E2D\u0E07\u0E21\u0E35\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E19\u0E49\u0E2D\u0E22 1 \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23")}onProductSearch(n,e){e.length>0?(this.filteredProducts=this.products.filter(i=>i.productName.toLowerCase().includes(e.toLowerCase())||i.sku&&i.sku.toLowerCase().includes(e.toLowerCase())),this.showSuggestions[n]=this.filteredProducts.length>0):(this.filteredProducts=[],this.showSuggestions[n]=!1)}selectProduct(n,e){this.orderItems[n].productId=e.productId,this.orderItems[n].productName=e.productName,this.orderItems[n].productSku=e.sku||"",this.orderItems[n].unitPrice=e.sellingPrice||0,this.showSuggestions[n]=!1,this.calculateItemTotal(n)}hideSuggestions(n){setTimeout(()=>{this.showSuggestions[n]=!1},200)}calculateItemTotal(n){let e=this.orderItems[n],i=e.quantity||0,t=e.unitPrice||0,r=e.discount||0,C=i*t-r;e.totalPrice=isNaN(C)||C<0?0:C,this.calculateTotals()}calculateTotals(){this.subtotal=this.orderItems.reduce((i,t)=>{let r=t.totalPrice||0;return i+r},0);let n=this.shippingFee||0,e=this.discount||0;this.netAmount=this.subtotal+n-e,this.netAmount<0&&(this.netAmount=0)}onSubmit(){if(!this.validateForm())return;this.submitting=!0;let n={orderNumber:this.orderNumber||void 0,source:this.source,customerName:this.customerName,customerPhone:this.customerPhone,shippingAddress:this.shippingAddress,orderDate:this.orderDate?new Date(this.orderDate).toISOString():void 0,deliveryDate:this.deliveryDate?new Date(this.deliveryDate).toISOString():void 0,shippingFee:this.shippingFee||0,discount:this.discount||0,notes:this.notes,orderItems:this.orderItems.map(i=>{let t=i.quantity||1,r=i.unitPrice||0,b=i.discount||0,O=t*r-b;return{productId:i.productId,productName:i.productName||"",productSku:i.productSku||"",quantity:t,unitPrice:r,discount:b,totalPrice:O>=0?O:0,notes:i.notes||""}})};(this.isEditMode?this.orderService.updateOrder(this.orderId,n):this.orderService.createOrder(n)).subscribe({next:i=>{let t=this.isEditMode?"\u0E41\u0E01\u0E49\u0E44\u0E02\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08":"\u0E2A\u0E23\u0E49\u0E32\u0E07\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08";!this.isEditMode&&i.orderId?this.createAutoTransaction(i.orderId,t):(alert(t),this.router.navigate(["/orders"]))},error:i=>{console.error("Error saving order:",i),alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14: "+(i.error?.message||i.message)),this.submitting=!1}})}createAutoTransaction(n,e){console.log("Creating auto transaction for order:",n),this.transactionService.createAutoTransactionForOrder(n).subscribe({next:i=>{console.log("\u2705 Auto transaction created:",i),alert(`${e}

\u{1F4CA} \u0E2A\u0E23\u0E49\u0E32\u0E07 Transaction \u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34:
- \u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17: ${i.type==="INCOME"?"\u0E23\u0E32\u0E22\u0E23\u0E31\u0E1A":"\u0E23\u0E32\u0E22\u0E08\u0E48\u0E32\u0E22"}
- \u0E08\u0E33\u0E19\u0E27\u0E19\u0E40\u0E07\u0E34\u0E19: ${this.formatCurrency(i.amount)}
- \u0E2B\u0E21\u0E27\u0E14\u0E2B\u0E21\u0E39\u0E48: ${this.transactionService.getCategoryLabel(i.category)}`),this.router.navigate(["/orders"])},error:i=>{console.error("\u274C Error creating auto transaction:",i),alert(`${e}

\u26A0\uFE0F \u0E2A\u0E23\u0E49\u0E32\u0E07\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08\u0E41\u0E15\u0E48\u0E44\u0E21\u0E48\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E2A\u0E23\u0E49\u0E32\u0E07 Transaction \u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34\u0E44\u0E14\u0E49
\u0E04\u0E38\u0E13\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E40\u0E1E\u0E34\u0E48\u0E21 Transaction \u0E14\u0E49\u0E27\u0E22\u0E15\u0E19\u0E40\u0E2D\u0E07\u0E20\u0E32\u0E22\u0E2B\u0E25\u0E31\u0E07\u0E44\u0E14\u0E49`),this.router.navigate(["/orders"])}})}validateForm(){if(!this.customerName.trim())return alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E0A\u0E37\u0E48\u0E2D\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32"),!1;if(this.orderItems.length===0)return alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E19\u0E49\u0E2D\u0E22 1 \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23"),!1;for(let n=0;n<this.orderItems.length;n++){let e=this.orderItems[n];if(!e.productName||!e.productName.trim())return alert(`\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E17\u0E35\u0E48 ${n+1}: \u0E01\u0E23\u0E38\u0E13\u0E32\u0E01\u0E23\u0E2D\u0E01\u0E0A\u0E37\u0E48\u0E2D\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32`),!1;if(!e.quantity||e.quantity<=0)return alert(`\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E17\u0E35\u0E48 ${n+1}: \u0E08\u0E33\u0E19\u0E27\u0E19\u0E15\u0E49\u0E2D\u0E07\u0E21\u0E32\u0E01\u0E01\u0E27\u0E48\u0E32 0`),!1;if(e.unitPrice===null||e.unitPrice===void 0||e.unitPrice<0)return alert(`\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E17\u0E35\u0E48 ${n+1}: \u0E23\u0E32\u0E04\u0E32\u0E15\u0E49\u0E2D\u0E07\u0E44\u0E21\u0E48\u0E15\u0E34\u0E14\u0E25\u0E1A`),!1}return!0}goBack(){confirm("\u0E15\u0E49\u0E2D\u0E07\u0E01\u0E32\u0E23\u0E22\u0E01\u0E40\u0E25\u0E34\u0E01\u0E41\u0E25\u0E30\u0E01\u0E25\u0E31\u0E1A\u0E2B\u0E23\u0E37\u0E2D\u0E44\u0E21\u0E48? \u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E17\u0E35\u0E48\u0E01\u0E23\u0E2D\u0E01\u0E08\u0E30\u0E2B\u0E32\u0E22\u0E44\u0E1B")&&this.router.navigate(["/orders"])}formatCurrency(n){let e=n??0;return isNaN(e)?"\u0E3F0.00":`\u0E3F${e.toLocaleString("th-TH",{minimumFractionDigits:2,maximumFractionDigits:2})}`}static \u0275fac=function(e){return new(e||m)(v(K),v(Y),v(G),v(V),v(I))};static \u0275cmp=P({type:m,selectors:[["app-order-add"]],decls:2,vars:2,consts:[["class","add-order-container",4,"ngIf"],["class","loading-container",4,"ngIf"],[1,"add-order-container"],[1,"page-header"],[1,"back-btn",3,"click"],[1,"bi-arrow-left"],[1,"subtitle"],[1,"order-form",3,"ngSubmit"],[1,"form-section"],[1,"section-header"],[1,"bi-info-circle"],[1,"form-grid"],[1,"form-group"],["type","text","name","orderNumber","placeholder","\u0E1B\u0E25\u0E48\u0E2D\u0E22\u0E27\u0E48\u0E32\u0E07\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E2A\u0E23\u0E49\u0E32\u0E07\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-hint"],[1,"required"],["name","source","required","",1,"form-control",3,"ngModelChange","ngModel"],["value","MANUAL"],["value","SHOP_24"],["value","SHOPEE"],["type","datetime-local","name","orderDate","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","datetime-local","name","deliveryDate",1,"form-control",3,"ngModelChange","ngModel"],[1,"bi-person"],[1,"form-group","full-width"],["type","text","name","customerName","placeholder","\u0E0A\u0E37\u0E48\u0E2D-\u0E19\u0E32\u0E21\u0E2A\u0E01\u0E38\u0E25","required","",1,"form-control",3,"ngModelChange","ngModel"],["type","tel","name","customerPhone","placeholder","0812345678",1,"form-control",3,"ngModelChange","ngModel"],["name","shippingAddress","rows","3","placeholder","\u0E17\u0E35\u0E48\u0E2D\u0E22\u0E39\u0E48\u0E2A\u0E33\u0E2B\u0E23\u0E31\u0E1A\u0E08\u0E31\u0E14\u0E2A\u0E48\u0E07\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32",1,"form-control",3,"ngModelChange","ngModel"],[1,"bi-box-seam"],["type","button",1,"add-item-btn",3,"click"],[1,"bi-plus-circle"],[1,"items-container"],["class","item-card",4,"ngFor","ngForOf"],[1,"bi-calculator"],[1,"summary-container"],[1,"summary-left"],["type","number","name","shippingFee","step","0.01","min","0",1,"form-control",3,"ngModelChange","input","ngModel"],["type","number","name","discount","step","0.01","min","0",1,"form-control",3,"ngModelChange","input","ngModel"],["name","notes","rows","3","placeholder","\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E40\u0E15\u0E34\u0E21\u0E2A\u0E33\u0E2B\u0E23\u0E31\u0E1A\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C",1,"form-control",3,"ngModelChange","ngModel"],[1,"summary-right"],[1,"summary-row"],[1,"label"],[1,"value"],[1,"value","discount"],[1,"summary-row","total"],[1,"form-actions"],["type","button",1,"btn-cancel",3,"click"],[1,"bi-x-circle"],["type","submit",1,"btn-submit",3,"disabled"],["class","loading-spinner",4,"ngIf"],["class","bi-check-circle",4,"ngIf"],[1,"item-card"],[1,"item-header"],[1,"item-number"],["type","button","class","remove-item-btn",3,"click",4,"ngIf"],[1,"item-body"],[1,"form-row"],[1,"form-group","flex-2",2,"position","relative"],["type","text","placeholder","\u0E0A\u0E37\u0E48\u0E2D\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32","required","",1,"form-control",3,"ngModelChange","input","blur","ngModel","name"],["class","product-suggestions",4,"ngIf"],[1,"form-group","flex-1"],["type","text","placeholder","\u0E23\u0E2B\u0E31\u0E2A\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32",1,"form-control",3,"ngModelChange","ngModel","name"],["type","number","min","1","required","",1,"form-control",3,"ngModelChange","input","ngModel","name"],["type","number","step","0.01","min","0","required","",1,"form-control",3,"ngModelChange","input","ngModel","name"],["type","number","step","0.01","min","0",1,"form-control",3,"ngModelChange","input","ngModel","name"],["type","text","readonly","",1,"form-control","total-field",3,"value"],["type","text","placeholder","\u0E2B\u0E21\u0E32\u0E22\u0E40\u0E2B\u0E15\u0E38\u0E40\u0E1E\u0E34\u0E48\u0E21\u0E40\u0E15\u0E34\u0E21",1,"form-control",3,"ngModelChange","ngModel","name"],["type","button",1,"remove-item-btn",3,"click"],[1,"bi-trash"],[1,"product-suggestions"],["class","suggestion-item",3,"mousedown",4,"ngFor","ngForOf"],[1,"suggestion-item",3,"mousedown"],[1,"product-name"],["class","product-sku",4,"ngIf"],[1,"product-sku"],[1,"loading-spinner"],[1,"bi-check-circle"],[1,"loading-container"]],template:function(e,i){e&1&&x(0,ie,116,20,"div",0)(1,re,4,0,"div",1),e&2&&(E("ngIf",!i.loading),a(),E("ngIf",i.loading))},dependencies:[D,S,A,H,F,z,j,T,L,q,k,N,U,R,B,W],styles:['.add-order-container[_ngcontent-%COMP%]{margin:1rem;padding:1.5rem;background-color:#fff;border-radius:1rem;box-shadow:0 2px 8px #0000000d;border:1px solid #e5e7eb;min-height:calc(100vh - 2rem);font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;box-sizing:border-box}.page-header[_ngcontent-%COMP%]{margin-bottom:2rem}.back-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.75rem 1.25rem;background:#fff;border:1px solid #e2e8f0;border-radius:8px;cursor:pointer;color:#4a5568;margin-bottom:1rem;transition:all .2s}.back-btn[_ngcontent-%COMP%]:hover{background:#f7fafc;border-color:#cbd5e0}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:.5rem 0;font-size:2rem;color:#1a202c}.subtitle[_ngcontent-%COMP%]{color:#718096;margin:0}.order-form[_ngcontent-%COMP%]{max-width:1200px}.form-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;margin-bottom:2rem;box-shadow:0 2px 8px #0000000d}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:2px solid #f0f0f0}.section-header[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;color:#667eea}.section-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.3rem;color:#1a202c;flex:1}.add-item-btn[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#667eea;color:#fff;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;gap:.5rem;font-size:.9rem;transition:all .2s}.add-item-btn[_ngcontent-%COMP%]:hover{background:#5a67d8;transform:translateY(-2px)}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group.full-width[_ngcontent-%COMP%]{grid-column:1 / -1}.form-group.flex-1[_ngcontent-%COMP%]{flex:1}.form-group.flex-2[_ngcontent-%COMP%]{flex:2}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#4a5568;font-size:.9rem}.form-group[_ngcontent-%COMP%]   label.required[_ngcontent-%COMP%]:after{content:" *";color:#e53e3e}.form-control[_ngcontent-%COMP%]{padding:.75rem;border:2px solid #e2e8f0;border-radius:8px;font-size:.95rem;transition:all .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-control[_ngcontent-%COMP%]:disabled, .form-control[_ngcontent-%COMP%]:read-only{background:#f7fafc;cursor:not-allowed}.total-field[_ngcontent-%COMP%]{font-weight:600;color:#48bb78;background:#f0fff4!important}textarea.form-control[_ngcontent-%COMP%]{resize:vertical;min-height:80px}.form-hint[_ngcontent-%COMP%]{color:#a0aec0;font-size:.85rem;margin-top:.25rem}.items-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.item-card[_ngcontent-%COMP%]{border:2px solid #e2e8f0;border-radius:12px;overflow:hidden;transition:all .2s}.item-card[_ngcontent-%COMP%]:hover{border-color:#cbd5e0;box-shadow:0 4px 12px #0000000d}.item-header[_ngcontent-%COMP%]{background:#f7fafc;padding:1rem 1.5rem;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e2e8f0}.item-number[_ngcontent-%COMP%]{font-weight:600;color:#2d3748}.remove-item-btn[_ngcontent-%COMP%]{padding:.5rem .75rem;background:#fed7d7;color:#c53030;border:none;border-radius:6px;cursor:pointer;display:flex;align-items:center;gap:.5rem;transition:all .2s}.remove-item-btn[_ngcontent-%COMP%]:hover{background:#fc8181;color:#fff}.item-body[_ngcontent-%COMP%]{padding:1.5rem}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-bottom:1rem}.form-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.product-suggestions[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:2px solid #667eea;border-top:none;border-radius:0 0 8px 8px;max-height:200px;overflow-y:auto;z-index:1000;box-shadow:0 4px 12px #0000001a;margin-top:-2px}.suggestion-item[_ngcontent-%COMP%]{padding:.75rem 1rem;cursor:pointer;display:flex;flex-direction:column;gap:.25rem;border-bottom:1px solid #f0f0f0;transition:background .2s}.suggestion-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.suggestion-item[_ngcontent-%COMP%]:hover{background:#f7fafc}.product-name[_ngcontent-%COMP%]{font-weight:500;color:#2d3748}.product-sku[_ngcontent-%COMP%]{font-size:.85rem;color:#718096}.summary-container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:2rem}.summary-left[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.summary-right[_ngcontent-%COMP%]{background:#f7fafc;padding:1.5rem;border-radius:8px;display:flex;flex-direction:column;gap:1rem}.summary-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:.75rem 0;border-bottom:1px solid #e2e8f0}.summary-row[_ngcontent-%COMP%]:last-child{border-bottom:none}.summary-row.total[_ngcontent-%COMP%]{border-top:2px solid #cbd5e0;padding-top:1rem;margin-top:.5rem}.summary-row[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#4a5568}.summary-row[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-weight:600;color:#2d3748;font-size:1.1rem}.summary-row[_ngcontent-%COMP%]   .value.discount[_ngcontent-%COMP%]{color:#e53e3e}.summary-row.total[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-size:1.2rem;color:#1a202c}.summary-row.total[_ngcontent-%COMP%]   .value[_ngcontent-%COMP%]{font-size:1.5rem;color:#667eea}.form-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:flex-end;padding:2rem 0}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{padding:.875rem 2rem;border:none;border-radius:8px;font-size:1rem;font-weight:600;cursor:pointer;display:flex;align-items:center;gap:.5rem;transition:all .2s}.btn-cancel[_ngcontent-%COMP%]{background:#fff;color:#718096;border:2px solid #e2e8f0}.btn-cancel[_ngcontent-%COMP%]:hover{background:#f7fafc;border-color:#cbd5e0}.btn-submit[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.btn-submit[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 10px 25px #667eea4d}.btn-submit[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed}.loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px;color:#718096}.loading-spinner[_ngcontent-%COMP%]{width:40px;height:40px;border:4px solid #e2e8f0;border-top-color:#667eea;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite;margin-bottom:1rem}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}@media (max-width: 768px){.add-order-container[_ngcontent-%COMP%]{padding:1rem}.form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-row[_ngcontent-%COMP%]{flex-direction:column}.summary-container[_ngcontent-%COMP%]{grid-template-columns:1fr}.form-actions[_ngcontent-%COMP%]{flex-direction:column}.btn-cancel[_ngcontent-%COMP%], .btn-submit[_ngcontent-%COMP%]{width:100%;justify-content:center}}']})};export{J as OrderAddComponent};
