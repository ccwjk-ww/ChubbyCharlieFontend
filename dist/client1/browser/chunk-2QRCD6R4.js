import{a as ne}from"./chunk-CKHC3D5W.js";import{b as G,c as d,d as B,e as H,h as U,i as Y,j as J,m as $,n as K,o as Q,p as X,q as Z,s as ee,u as te}from"./chunk-OKAB5353.js";import{b as D,d as R}from"./chunk-ACYYDNGN.js";import"./chunk-ZATVBB7N.js";import{Bb as i,Cb as N,Db as L,Ha as r,La as v,Ra as z,Wa as p,gc as W,hb as s,ib as o,jb as t,jc as j,kb as c,rb as I,tb as k,zb as f}from"./chunk-45HGJHZR.js";function ie(a,n){a&1&&(o(0,"div",41),i(1," Employee name is required and must be at least 2 characters "),t())}function le(a,n){a&1&&(o(0,"div",41),i(1," Please enter a valid email address "),t())}function ae(a,n){a&1&&(o(0,"div",41),i(1," Address is required and must be at least 5 characters "),t())}function re(a,n){a&1&&(o(0,"div",41),i(1," Please enter a valid phone number (10-11 digits) "),t())}function de(a,n){a&1&&(o(0,"div",41),i(1," Employee type is required "),t())}function me(a,n){a&1&&(o(0,"div",41),i(1," Role is required "),t())}function se(a,n){a&1&&(o(0,"div",41),i(1," Daily wage is required and must be greater than 0 "),t())}function pe(a,n){if(a&1&&(o(0,"div",7)(1,"label",42),i(2,"Daily Wage (\u0E3F)"),t(),c(3,"input",43),p(4,se,2,0,"div",10),t()),a&2){let l,e,m=k();r(3),f("error",((l=m.staffForm.get("dailyWage"))==null?null:l.invalid)&&((l=m.staffForm.get("dailyWage"))==null?null:l.touched)),r(),s("ngIf",((e=m.staffForm.get("dailyWage"))==null?null:e.invalid)&&((e=m.staffForm.get("dailyWage"))==null?null:e.touched))}}function fe(a,n){a&1&&(o(0,"div",41),i(1," Monthly salary is required and must be greater than 0 "),t())}function ce(a,n){if(a&1&&(o(0,"div",7)(1,"label",44),i(2,"Monthly Salary (\u0E3F)"),t(),c(3,"input",45),p(4,fe,2,0,"div",10),t()),a&2){let l,e,m=k();r(3),f("error",((l=m.staffForm.get("monthlySalary"))==null?null:l.invalid)&&((l=m.staffForm.get("monthlySalary"))==null?null:l.touched)),r(),s("ngIf",((e=m.staffForm.get("monthlySalary"))==null?null:e.invalid)&&((e=m.staffForm.get("monthlySalary"))==null?null:e.touched))}}function ue(a,n){a&1&&(o(0,"div",41),i(1," Username is required and must be at least 3 characters "),t())}function ge(a,n){a&1&&(o(0,"div",41),i(1," Password is required and must be at least 6 characters "),t())}function he(a,n){a&1&&(o(0,"div",41),i(1," Status is required "),t())}var oe=class a{constructor(n,l,e,m){this.fb=n;this.employeeService=l;this.router=e;this.route=m;this.staffForm=this.fb.group({empName:["",[d.required,d.minLength(2)]],empAddress:["",[d.required,d.minLength(5)]],empPhone:["",[d.required,d.pattern(/^[0-9]{10,11}$/)]],empType:["",d.required],dailyWage:[{value:"",disabled:!0},[d.min(0)]],monthlySalary:[{value:"",disabled:!0},[d.min(0)]],role:["",d.required],username:["",[d.required,d.minLength(3)]],password:["",[d.required,d.minLength(6)]],email:["",[d.required,d.email]],status:["ACTIVE",d.required]})}staffForm;selectedFile=null;isEditMode=!1;employeeId=null;ngOnInit(){this.employeeId=this.route.snapshot.paramMap.get("id")?Number(this.route.snapshot.paramMap.get("id")):null,this.isEditMode=!!this.employeeId,this.isEditMode&&this.loadEmployee(),this.staffForm.get("empType")?.valueChanges.subscribe(n=>{this.handleEmpTypeChange(n)})}loadEmployee(){this.employeeId&&this.employeeService.getEmployeeById(this.employeeId).subscribe({next:n=>{this.staffForm.patchValue({empName:n.empName,empAddress:n.empAddress,empPhone:n.empPhone,empType:n.empType,dailyWage:n.dailyWage,monthlySalary:n.monthlySalary,role:n.role,username:n.username,email:n.email}),this.handleEmpTypeChange(n.empType)},error:n=>console.error("Error loading employee:",n)})}handleEmpTypeChange(n){let l=this.staffForm.get("dailyWage"),e=this.staffForm.get("monthlySalary");n==="DAILY"?(l?.enable(),l?.setValidators([d.required,d.min(0)]),e?.disable(),e?.clearValidators(),e?.setValue(null)):n==="MONTHLY"?(e?.enable(),e?.setValidators([d.required,d.min(0)]),l?.disable(),l?.clearValidators(),l?.setValue(null)):(l?.disable(),e?.disable(),l?.clearValidators(),e?.clearValidators()),l?.updateValueAndValidity(),e?.updateValueAndValidity()}triggerFileUpload(){document.querySelector('input[type="file"]')?.click()}onFileSelected(n){let e=n.target.files?.[0];if(e){if(!["image/jpeg","image/jpg","image/png"].includes(e.type)){alert("Please upload only JPG, JPEG, or PNG files");return}if(e.size>2*1024*1024){alert("File size must be less than 2MB");return}this.selectedFile=e;let u=new FileReader;u.onload=g=>{let h=document.querySelector(".upload-placeholder");h&&g.target?.result&&(h.innerHTML=`<img src="${g.target.result}" style="width: 100%; height: 100%; object-fit: cover; border-radius: 50%;">`)},u.readAsDataURL(e)}}onSubmit(){if(this.staffForm.valid){let n=this.staffForm.value;this.isEditMode&&this.employeeId?this.employeeService.updateEmployee(this.employeeId,n).subscribe({next:()=>{alert("Employee updated successfully!"),this.router.navigate(["/staff"])},error:l=>console.error("Error updating employee:",l)}):this.employeeService.createEmployee(n).subscribe({next:()=>{alert("Employee added successfully!"),this.resetForm(),this.router.navigate(["/staff"])},error:l=>console.error("Error adding employee:",l)})}else this.markFormGroupTouched()}markFormGroupTouched(){Object.keys(this.staffForm.controls).forEach(n=>{this.staffForm.get(n)?.markAsTouched()})}resetForm(){this.staffForm.reset(),this.selectedFile=null;let n=document.querySelector(".upload-placeholder");n&&(n.innerHTML=`
        <i class="fas fa-camera"></i>
        <p>Upload photo</p>
      `)}goBack(){this.router.navigate(["/staff"])}generateUsername(){let n=this.staffForm.get("empName")?.value;if(n){let l=n.toLowerCase().replace(/\s+/g,"")+Math.floor(Math.random()*1e3);this.staffForm.get("username")?.setValue(l)}}static \u0275fac=function(l){return new(l||a)(v(ee),v(ne),v(R),v(D))};static \u0275cmp=z({type:a,selectors:[["app-staff-add"]],decls:88,vars:34,consts:[[1,"main-container"],[1,"container"],[1,"page-header"],[1,"staff-form",3,"ngSubmit","formGroup"],[1,"form-row"],[1,"form-fields"],[1,"field-row"],[1,"form-group"],["for","empName"],["id","empName","formControlName","empName","placeholder","Enter employee name",1,"form-control"],["class","error-message",4,"ngIf"],["for","email"],["id","email","formControlName","email","placeholder","Enter email address",1,"form-control"],["for","empAddress"],["id","empAddress","formControlName","empAddress","placeholder","Enter employee address",1,"form-control"],["for","empPhone"],["id","empPhone","formControlName","empPhone","placeholder","Enter phone number",1,"form-control"],["for","empType"],["id","empType","formControlName","empType",1,"form-control"],["value",""],["value","DAILY"],["value","MONTHLY"],["for","role"],["id","role","formControlName","role",1,"form-control"],["value","Admin"],["value","Manager"],["value","Operations"],["class","form-group",4,"ngIf"],["for","username"],["id","username","formControlName","username","placeholder","Enter username",1,"form-control"],["for","password"],["id","password","formControlName","password","placeholder","Enter password","type","password",1,"form-control"],["for","status"],["id","status","formControlName","status",1,"form-control"],["value","ACTIVE"],["value","INACTIVE"],[1,"form-actions"],["type","button",1,"back-btn",3,"click"],[1,"fas","fa-arrow-left"],["type","submit",1,"submit-btn",3,"disabled"],[1,"fas","fa-plus"],[1,"error-message"],["for","dailyWage"],["id","dailyWage","formControlName","dailyWage","placeholder","Enter daily wage amount","type","number","min","0","step","0.01",1,"form-control"],["for","monthlySalary"],["id","monthlySalary","formControlName","monthlySalary","placeholder","Enter monthly salary amount","type","number","min","0","step","0.01",1,"form-control"]],template:function(l,e){if(l&1&&(o(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),i(4),t(),o(5,"p"),i(6),t()(),o(7,"form",3),I("ngSubmit",function(){return e.onSubmit()}),o(8,"div",4)(9,"div",5)(10,"div",6)(11,"div",7)(12,"label",8),i(13,"Employee Name"),t(),c(14,"input",9),p(15,ie,2,0,"div",10),t(),o(16,"div",7)(17,"label",11),i(18,"Email"),t(),c(19,"input",12),p(20,le,2,0,"div",10),t()(),o(21,"div",6)(22,"div",7)(23,"label",13),i(24,"Address"),t(),c(25,"input",14),p(26,ae,2,0,"div",10),t(),o(27,"div",7)(28,"label",15),i(29,"Phone Number"),t(),c(30,"input",16),p(31,re,2,0,"div",10),t()(),o(32,"div",6)(33,"div",7)(34,"label",17),i(35,"Employee Type"),t(),o(36,"select",18)(37,"option",19),i(38,"Select employee type"),t(),o(39,"option",20),i(40,"Daily Worker"),t(),o(41,"option",21),i(42,"Monthly Worker"),t()(),p(43,de,2,0,"div",10),t(),o(44,"div",7)(45,"label",22),i(46,"Role"),t(),o(47,"select",23)(48,"option",19),i(49,"Select role"),t(),o(50,"option",24),i(51,"Admin"),t(),o(52,"option",25),i(53,"Manager"),t(),o(54,"option",26),i(55,"Operations"),t()(),p(56,me,2,0,"div",10),t()(),o(57,"div",6),p(58,pe,5,3,"div",27)(59,ce,5,3,"div",27),t(),o(60,"div",6)(61,"div",7)(62,"label",28),i(63,"Username"),t(),c(64,"input",29),p(65,ue,2,0,"div",10),t(),o(66,"div",7)(67,"label",30),i(68,"Password"),t(),c(69,"input",31),p(70,ge,2,0,"div",10),t()(),o(71,"div",6)(72,"div",7)(73,"label",32),i(74,"Status"),t(),o(75,"select",33)(76,"option",34),i(77,"Active"),t(),o(78,"option",35),i(79,"Inactive"),t()(),p(80,he,2,0,"div",10),t()()()(),o(81,"div",36)(82,"button",37),I("click",function(){return e.goBack()}),c(83,"i",38),i(84," Back "),t(),o(85,"button",39),c(86,"i",40),i(87),t()()()()()),l&2){let m,u,g,h,_,b,y,x,E,M,P,C,q,V,S,F,O,w,A,T;r(4),N(e.isEditMode?"Edit Employee":"New Employee"),r(2),N(e.isEditMode?"Update employee details":"Create account for a new employee"),r(),s("formGroup",e.staffForm),r(7),f("error",((m=e.staffForm.get("empName"))==null?null:m.invalid)&&((m=e.staffForm.get("empName"))==null?null:m.touched)),r(),s("ngIf",((u=e.staffForm.get("empName"))==null?null:u.invalid)&&((u=e.staffForm.get("empName"))==null?null:u.touched)),r(4),f("error",((g=e.staffForm.get("email"))==null?null:g.invalid)&&((g=e.staffForm.get("email"))==null?null:g.touched)),r(),s("ngIf",((h=e.staffForm.get("email"))==null?null:h.invalid)&&((h=e.staffForm.get("email"))==null?null:h.touched)),r(5),f("error",((_=e.staffForm.get("empAddress"))==null?null:_.invalid)&&((_=e.staffForm.get("empAddress"))==null?null:_.touched)),r(),s("ngIf",((b=e.staffForm.get("empAddress"))==null?null:b.invalid)&&((b=e.staffForm.get("empAddress"))==null?null:b.touched)),r(4),f("error",((y=e.staffForm.get("empPhone"))==null?null:y.invalid)&&((y=e.staffForm.get("empPhone"))==null?null:y.touched)),r(),s("ngIf",((x=e.staffForm.get("empPhone"))==null?null:x.invalid)&&((x=e.staffForm.get("empPhone"))==null?null:x.touched)),r(5),f("error",((E=e.staffForm.get("empType"))==null?null:E.invalid)&&((E=e.staffForm.get("empType"))==null?null:E.touched)),r(7),s("ngIf",((M=e.staffForm.get("empType"))==null?null:M.invalid)&&((M=e.staffForm.get("empType"))==null?null:M.touched)),r(4),f("error",((P=e.staffForm.get("role"))==null?null:P.invalid)&&((P=e.staffForm.get("role"))==null?null:P.touched)),r(9),s("ngIf",((C=e.staffForm.get("role"))==null?null:C.invalid)&&((C=e.staffForm.get("role"))==null?null:C.touched)),r(2),s("ngIf",((q=e.staffForm.get("empType"))==null?null:q.value)==="DAILY"),r(),s("ngIf",((V=e.staffForm.get("empType"))==null?null:V.value)==="MONTHLY"),r(5),f("error",((S=e.staffForm.get("username"))==null?null:S.invalid)&&((S=e.staffForm.get("username"))==null?null:S.touched)),r(),s("ngIf",((F=e.staffForm.get("username"))==null?null:F.invalid)&&((F=e.staffForm.get("username"))==null?null:F.touched)),r(4),f("error",((O=e.staffForm.get("password"))==null?null:O.invalid)&&((O=e.staffForm.get("password"))==null?null:O.touched)),r(),s("ngIf",((w=e.staffForm.get("password"))==null?null:w.invalid)&&((w=e.staffForm.get("password"))==null?null:w.touched)),r(5),f("error",((A=e.staffForm.get("status"))==null?null:A.invalid)&&((A=e.staffForm.get("status"))==null?null:A.touched)),r(5),s("ngIf",((T=e.staffForm.get("status"))==null?null:T.invalid)&&((T=e.staffForm.get("status"))==null?null:T.touched)),r(5),s("disabled",e.staffForm.invalid),r(2),L(" ",e.isEditMode?"Update Employee":"Add Employee"," ")}},dependencies:[te,U,Q,X,G,Y,K,B,H,Z,J,$,j,W],styles:[`.main-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:flex-start;margin:1rem;padding:1.5rem;background-color:#fff;border-radius:1rem;box-shadow:0 2px 8px #0000000d;border:1px solid #e5e7eb;min-height:calc(100vh - 2rem);font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;box-sizing:border-box}.container[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto;padding:20px}.back-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#6c757d,#495057);border:none;color:#fff;padding:14px 32px;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;min-width:140px;display:flex;align-items:center;gap:8px;justify-content:center;box-shadow:0 2px 8px #00000026}.back-btn[_ngcontent-%COMP%]:hover{background:linear-gradient(135deg,#495057,#343a40);transform:translateY(-2px);box-shadow:0 4px 12px #0003}.back-btn[_ngcontent-%COMP%]:active{transform:translateY(0);box-shadow:0 2px 8px #00000026}.back-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.page-header[_ngcontent-%COMP%]{margin-bottom:40px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:32px;font-weight:700;margin:0 0 5px;color:#212529}.page-header[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#6c757d;margin:0;font-size:16px}.staff-form[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:40px;box-shadow:0 2px 20px #00000014;border:1px solid #e9ecef}.form-row[_ngcontent-%COMP%]{display:block;margin-bottom:40px}.photo-upload-section[_ngcontent-%COMP%]{flex:0 0 200px;display:flex;flex-direction:column;align-items:center}.photo-upload[_ngcontent-%COMP%]{width:150px;height:150px;border:2px dashed #dee2e6;border-radius:50%;display:flex;align-items:center;justify-content:center;cursor:pointer;margin-bottom:20px;transition:all .3s ease;background-color:#f8f9fa}.photo-upload[_ngcontent-%COMP%]:hover{border-color:#007bff;background-color:#e7f3ff}.upload-placeholder[_ngcontent-%COMP%]{text-align:center;color:#6c757d}.upload-placeholder[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px;margin-bottom:8px;display:block}.upload-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px;font-weight:500}.upload-info[_ngcontent-%COMP%]{text-align:center}.format-text[_ngcontent-%COMP%], .size-text[_ngcontent-%COMP%]{font-size:12px;color:#6c757d;margin:0 0 4px;font-weight:500}.formats[_ngcontent-%COMP%], .size[_ngcontent-%COMP%]{font-size:14px;font-weight:600;margin:0 0 15px;color:#495057}.form-fields[_ngcontent-%COMP%]{flex:1}.field-row[_ngcontent-%COMP%]{display:flex;gap:20px;margin-bottom:25px}.form-group[_ngcontent-%COMP%]{flex:1;position:relative}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:600;color:#212529;font-size:14px}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px 16px;border:1px solid #dee2e6;border-radius:8px;font-size:14px;transition:all .3s ease;background-color:#fff;box-sizing:border-box}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#007bff;box-shadow:0 0 0 3px #007bff1a;background-color:#fff}.form-control[_ngcontent-%COMP%]::placeholder{color:#adb5bd}.form-control.error[_ngcontent-%COMP%]{border-color:#dc3545;background-color:#fff5f5}.form-control.error[_ngcontent-%COMP%]:focus{border-color:#dc3545;box-shadow:0 0 0 3px #dc35451a}select.form-control[_ngcontent-%COMP%]{background-image:url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");background-position:right 12px center;background-repeat:no-repeat;background-size:16px;appearance:none;padding-right:40px}.error-message[_ngcontent-%COMP%]{margin-top:5px;font-size:12px;color:#dc3545;font-weight:500}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}.form-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-start;align-items:center;gap:20px;padding:20px 0;border-top:1px solid #e9ecef}.submit-btn[_ngcontent-%COMP%]{background:linear-gradient(135deg,#007bff,#0056b3);color:#fff;border:none;padding:14px 32px;border-radius:8px;font-size:16px;font-weight:600;cursor:pointer;transition:all .3s ease;min-width:140px;display:flex;align-items:center;gap:8px;justify-content:center}.submit-btn[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:14px}.submit-btn[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 4px 15px #007bff4d;background:linear-gradient(135deg,#0056b3,#004085)}.submit-btn[_ngcontent-%COMP%]:disabled{background:#6c757d;cursor:not-allowed;transform:none;box-shadow:none;opacity:.6}@media (max-width: 1024px){.container[_ngcontent-%COMP%]{padding:15px}.staff-form[_ngcontent-%COMP%]{padding:30px}}@media (max-width: 768px){.container[_ngcontent-%COMP%]{padding:10px}.header[_ngcontent-%COMP%]{flex-direction:column;gap:15px;align-items:flex-start}.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:30px}.field-row[_ngcontent-%COMP%]{flex-direction:column;gap:20px}.photo-upload-section[_ngcontent-%COMP%]{flex:none;align-self:center;margin-bottom:10px}.staff-form[_ngcontent-%COMP%]{padding:20px}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px}}@media (max-width: 480px){.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}.staff-form[_ngcontent-%COMP%]{padding:15px}.photo-upload[_ngcontent-%COMP%]{width:120px;height:120px}.submit-btn[_ngcontent-%COMP%]{width:100%;padding:16px}}@keyframes _ngcontent-%COMP%_pulse{0%{transform:scale(1)}50%{transform:scale(1.05)}to{transform:scale(1)}}.submit-btn[_ngcontent-%COMP%]:active{animation:_ngcontent-%COMP%_pulse .3s ease-in-out}`]})};export{oe as StaffAdd};
