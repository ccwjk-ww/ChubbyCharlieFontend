import{a as N}from"./chunk-7AEJN7K3.js";import{a as V}from"./chunk-LD5BFJQC.js";import{a as T,b as F,d as U,g as B,r as z,t as G}from"./chunk-OKAB5353.js";import{d as A}from"./chunk-ACYYDNGN.js";import"./chunk-ZATVBB7N.js";import{Ab as S,Bb as r,Cb as E,Db as x,Gb as b,Ha as u,Hb as O,Ib as P,La as C,Ra as M,Wa as c,Z as g,_ as f,fc as I,gc as D,hb as d,ib as i,jb as n,jc as k,kb as m,qb as v,rb as _,tb as s,xb as w,yb as y,zb as h}from"./chunk-45HGJHZR.js";function W(o,t){if(o&1&&(i(0,"div",38)(1,"div",39),r(2,"\u0E04\u0E27\u0E32\u0E21\u0E41\u0E21\u0E48\u0E19\u0E22\u0E33:"),n(),i(3,"div",40),m(4,"div",41),n(),i(5,"div",42),r(6),n()()),o&2){let e=s(2);u(4),y("width",e.parsingAccuracy,"%"),u(2),x("",e.parsingAccuracy,"%")}}function $(o,t){if(o&1&&(i(0,"div",34)(1,"div",35),m(2,"i",30),n(),i(3,"div",36)(4,"h4"),r(5),n(),i(6,"p"),r(7),n(),c(8,W,7,3,"div",37),n()()),o&2){let e=s();u(2),h("spinning",e.isGeminiProcessing),u(3),E(e.isGeminiProcessing?"Gemini AI \u0E01\u0E33\u0E25\u0E31\u0E07\u0E17\u0E33\u0E07\u0E32\u0E19...":"\u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E14\u0E49\u0E27\u0E22 Gemini AI"),u(2),E(e.geminiProgress),u(),d("ngIf",e.parsingAccuracy>0&&!e.isGeminiProcessing)}}function q(o,t){o&1&&(i(0,"small",48),r(1," \u2713 \u0E40\u0E25\u0E37\u0E2D\u0E01\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32\u0E41\u0E25\u0E49\u0E27 "),n())}function L(o,t){if(o&1&&(i(0,"span",59),r(1),n()),o&2){let e=s().$implicit;u(),E(e.customerPhone)}}function j(o,t){if(o&1){let e=v();i(0,"div",56),_("mousedown",function(){let l=g(e).$implicit,p=s(3);return f(p.selectCustomer(l))}),i(1,"span",57),r(2),n(),c(3,L,2,1,"span",58),n()}if(o&2){let e=t.$implicit;u(2),E(e.customerName),u(),d("ngIf",e.customerPhone)}}function Y(o,t){if(o&1&&(i(0,"div",54),c(1,j,4,2,"div",55),n()),o&2){let e=s(2);u(),d("ngForOf",e.filteredCustomers)}}function K(o,t){o&1&&(i(0,"div",60),r(1," \u0E44\u0E21\u0E48\u0E1E\u0E1A\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32 "),n())}function X(o,t){if(o&1){let e=v();i(0,"div",43)(1,"h3"),r(2,"\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C"),n(),i(3,"div",44)(4,"div",45)(5,"label",46),r(6,"\u0E40\u0E25\u0E02\u0E17\u0E35\u0E48\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C (PO Number)"),n(),i(7,"input",47),P("ngModelChange",function(l){g(e);let p=s();return O(p.orderNumber,l)||(p.orderNumber=l),f(l)}),n(),i(8,"small",48),r(9,"\u0E23\u0E30\u0E1A\u0E38\u0E40\u0E25\u0E02\u0E17\u0E35\u0E48 PO \u0E08\u0E32\u0E01\u0E40\u0E2D\u0E01\u0E2A\u0E32\u0E23"),n()(),i(10,"div",49)(11,"label",46),r(12,"\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32"),n(),i(13,"input",50),P("ngModelChange",function(l){g(e);let p=s();return O(p.searchCustomerTerm,l)||(p.searchCustomerTerm=l),f(l)}),_("input",function(){g(e);let l=s();return f(l.onCustomerSearch())})("focus",function(){g(e);let l=s();return f(l.showCustomerDropdown=!0)})("blur",function(){g(e);let l=s();return f(l.hideCustomerDropdown())}),n(),c(14,q,2,0,"small",51)(15,Y,2,1,"div",52)(16,K,2,0,"div",53),n()()()}if(o&2){let e=s();u(7),b("ngModel",e.orderNumber),u(6),b("ngModel",e.searchCustomerTerm),u(),d("ngIf",e.selectedCustomerId),u(),d("ngIf",e.showCustomerDropdown&&e.filteredCustomers.length>0),u(),d("ngIf",e.showCustomerDropdown&&e.filteredCustomers.length===0)}}function H(o,t){o&1&&m(0,"i",69)}function Q(o,t){o&1&&(i(0,"p"),r(1," \u{1F916} \u0E23\u0E30\u0E1A\u0E1A\u0E08\u0E30\u0E43\u0E0A\u0E49 Gemini AI \u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E44\u0E1F\u0E25\u0E4C\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34 "),n())}function J(o,t){o&1&&(i(0,"p"),r(1," \u0E2B\u0E23\u0E37\u0E2D\u0E04\u0E25\u0E34\u0E01\u0E40\u0E1E\u0E37\u0E48\u0E2D\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E44\u0E1F\u0E25\u0E4C Excel "),n())}function Z(o,t){if(o&1){let e=v();i(0,"div",61)(1,"div",62),m(2,"i",63),c(3,H,1,0,"i",64),n(),i(4,"h3"),r(5,"\u0E25\u0E32\u0E01\u0E44\u0E1F\u0E25\u0E4C\u0E21\u0E32\u0E27\u0E32\u0E07\u0E17\u0E35\u0E48\u0E19\u0E35\u0E48"),n(),c(6,Q,2,0,"p",65)(7,J,2,0,"p",65),i(8,"input",66,0),_("change",function(l){g(e);let p=s();return f(p.onFileSelected(l))}),n(),i(10,"button",67),_("click",function(){g(e);let l=w(9);return f(l.click())}),r(11," \u0E40\u0E25\u0E37\u0E2D\u0E01\u0E44\u0E1F\u0E25\u0E4C "),n(),i(12,"small",68),r(13),n()()}if(o&2){let e=s();u(3),d("ngIf",e.uploadType==="24shop"),u(3),d("ngIf",e.uploadType==="24shop"),u(),d("ngIf",e.uploadType==="shopee"),u(),d("accept",e.uploadType==="24shop"?".pdf":".xlsx,.xls"),u(5),x(" \u0E23\u0E2D\u0E07\u0E23\u0E31\u0E1A\u0E44\u0E1F\u0E25\u0E4C: ",e.uploadType==="24shop"?"PDF":"Excel (XLSX, XLS)"," ")}}function ee(o,t){o&1&&(i(0,"span",75),r(1," \u{1F916} \u0E08\u0E30\u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E14\u0E49\u0E27\u0E22 Gemini AI "),n())}function te(o,t){if(o&1){let e=v();i(0,"div",70),m(1,"i"),i(2,"div",71)(3,"h4"),r(4),n(),i(5,"p"),r(6),n(),c(7,ee,2,0,"span",72),n(),i(8,"button",73),_("click",function(){g(e);let l=s();return f(l.removeFile())}),m(9,"i",74),n()()}if(o&2){let e=s();u(),S(e.getFileIcon()),u(3),E(e.selectedFile.name),u(2),E(e.formatFileSize(e.selectedFile.size)),u(),d("ngIf",e.uploadType==="24shop"),u(),d("disabled",e.uploading)}}function ne(o,t){if(o&1){let e=v();i(0,"div",76)(1,"label",77)(2,"input",78),P("ngModelChange",function(l){g(e);let p=s();return O(p.autoDeductStock,l)||(p.autoDeductStock=l),f(l)}),n(),i(3,"div",79)(4,"span"),r(5,"\u0E15\u0E31\u0E14 Stock \u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34\u0E2B\u0E25\u0E31\u0E07\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14"),n(),i(6,"small"),r(7,"\u0E23\u0E30\u0E1A\u0E1A\u0E08\u0E30\u0E15\u0E31\u0E14 Stock \u0E15\u0E32\u0E21\u0E08\u0E33\u0E19\u0E27\u0E19\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32\u0E43\u0E19\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C\u0E17\u0E31\u0E19\u0E17\u0E35"),n()()()()}if(o&2){let e=s();u(2),b("ngModel",e.autoDeductStock)}}function ie(o,t){o&1&&(i(0,"span"),r(1,"\u{1F916} \u0E14\u0E39\u0E15\u0E31\u0E27\u0E2D\u0E22\u0E48\u0E32\u0E07 (Gemini)"),n())}function re(o,t){o&1&&(i(0,"span"),r(1,"\u0E14\u0E39\u0E15\u0E31\u0E27\u0E2D\u0E22\u0E48\u0E32\u0E07"),n())}function oe(o,t){o&1&&m(0,"div",86)}function ue(o,t){o&1&&m(0,"i",87)}function ae(o,t){if(o&1){let e=v();i(0,"div",80)(1,"button",81),_("click",function(){g(e);let l=s();return f(l.previewFile())}),m(2,"i",82),c(3,ie,2,0,"span",65)(4,re,2,0,"span",65),n(),i(5,"button",83),_("click",function(){g(e);let l=s();return f(l.uploadFile())}),c(6,oe,1,0,"div",84)(7,ue,1,0,"i",85),r(8),n()()}if(o&2){let e=s();u(),d("disabled",e.uploading),u(2),d("ngIf",e.uploadType==="24shop"),u(),d("ngIf",e.uploadType==="shopee"),u(),d("disabled",e.uploading),u(),d("ngIf",e.uploading),u(),d("ngIf",!e.uploading),u(),x(" ",e.uploading?"\u0E01\u0E33\u0E25\u0E31\u0E07\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14...":"\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14"," ")}}function le(o,t){if(o&1&&(i(0,"tr",98)(1,"td"),r(2),n(),i(3,"td")(4,"span",99),r(5),n()(),i(6,"td",100),r(7),n(),i(8,"td",92)(9,"span",101),r(10),n()(),i(11,"td",93),r(12),n(),i(13,"td",93)(14,"strong"),r(15),n()(),i(16,"td",92)(17,"span",102),m(18,"i",103),r(19," \u0E16\u0E39\u0E01\u0E15\u0E49\u0E2D\u0E07 "),n()()()),o&2){let e=t.$implicit,a=t.index,l=s(2);u(2),E(a+1),u(3),E(e.productSku),u(2),x(" ",e.productName," "),u(3),E(e.quantity),u(2),E(l.formatCurrency(e.unitPrice)),u(3),E(l.formatCurrency(e.totalPrice))}}function de(o,t){if(o&1&&(i(0,"div",88)(1,"div",89)(2,"h3"),m(3,"i",30),r(4),n(),i(5,"span",90),r(6," \u{1F916} \u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E14\u0E49\u0E27\u0E22 Gemini AI "),n()(),i(7,"div",91)(8,"table")(9,"thead")(10,"tr")(11,"th"),r(12,"#"),n(),i(13,"th"),r(14,"SKU"),n(),i(15,"th"),r(16,"\u0E0A\u0E37\u0E48\u0E2D\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32"),n(),i(17,"th",92),r(18,"\u0E08\u0E33\u0E19\u0E27\u0E19"),n(),i(19,"th",93),r(20,"\u0E23\u0E32\u0E04\u0E32/\u0E2B\u0E19\u0E48\u0E27\u0E22"),n(),i(21,"th",93),r(22,"\u0E23\u0E27\u0E21"),n(),i(23,"th",92),r(24,"\u0E2A\u0E16\u0E32\u0E19\u0E30"),n()()(),i(25,"tbody"),c(26,le,20,6,"tr",94),n(),i(27,"tfoot")(28,"tr",95)(29,"td",96)(30,"strong"),r(31,"\u0E22\u0E2D\u0E14\u0E23\u0E27\u0E21\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14:"),n()(),i(32,"td",93)(33,"strong",97),r(34),n()(),m(35,"td"),n()()()()()),o&2){let e=s();u(4),x(" \u0E15\u0E31\u0E27\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32 (",e.previewItems.length," \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23) "),u(22),d("ngForOf",e.previewItems),u(8),x(" ",e.formatCurrency(e.getTotalPreviewAmount())," ")}}function se(o,t){if(o&1&&(i(0,"div",110)(1,"span",111),r(2,"\u0E40\u0E1A\u0E2D\u0E23\u0E4C\u0E42\u0E17\u0E23:"),n(),i(3,"span",112),r(4),n()()),o&2){let e=s().$implicit;u(4),E(e.customerPhone)}}function Ee(o,t){if(o&1&&(i(0,"div",110)(1,"span",111),r(2,"\u0E17\u0E35\u0E48\u0E2D\u0E22\u0E39\u0E48:"),n(),i(3,"span",112),r(4),n()()),o&2){let e=s().$implicit;u(4),E(e.shippingAddress)}}function ce(o,t){if(o&1&&(i(0,"div",118)(1,"span",119),r(2),n(),i(3,"span",120),r(4),n(),i(5,"span",121),r(6),n()()),o&2){let e=t.$implicit,a=s(4);u(2),E(e.productName),u(2),x("x ",e.quantity),u(2),E(a.formatCurrency(e.totalPrice))}}function me(o,t){if(o&1&&(i(0,"div",116)(1,"h5"),r(2),n(),c(3,ce,7,3,"div",117),n()),o&2){let e=s().$implicit;u(2),x("\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32 (",e.orderItems.length," \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23)"),u(),d("ngForOf",e.orderItems)}}function pe(o,t){if(o&1&&(i(0,"div",107)(1,"div",89)(2,"h4"),r(3),n(),i(4,"span",108),r(5),n()(),i(6,"div",109)(7,"div",110)(8,"span",111),r(9,"\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32:"),n(),i(10,"span",112),r(11),n()(),c(12,se,5,1,"div",113)(13,Ee,5,1,"div",113),i(14,"div",110)(15,"span",111),r(16,"\u0E22\u0E2D\u0E14\u0E23\u0E27\u0E21:"),n(),i(17,"span",114),r(18),n()()(),c(19,me,4,2,"div",115),n()),o&2){let e=t.$implicit,a=s(2);u(3),E(e.orderNumber),u(2),E(e.source==="SHOP_24"?"24Shop":"Shopee"),u(6),E(e.customerName),u(),d("ngIf",e.customerPhone),u(),d("ngIf",e.shippingAddress),u(5),E(a.formatCurrency(e.netAmount)),u(),d("ngIf",e.orderItems&&e.orderItems.length>0)}}function ge(o,t){if(o&1&&(i(0,"div",104)(1,"h3"),r(2,"\u0E15\u0E31\u0E27\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C"),n(),i(3,"div",105),c(4,pe,20,7,"div",106),n()()),o&2){let e=s();u(4),d("ngForOf",e.previewOrders)}}function fe(o,t){o&1&&m(0,"i",103)}function _e(o,t){o&1&&m(0,"i",131)}function xe(o,t){o&1&&(i(0,"div",132)(1,"div",133),m(2,"i",30),i(3,"span"),r(4,"\u0E1B\u0E23\u0E30\u0E21\u0E27\u0E25\u0E1C\u0E25\u0E14\u0E49\u0E27\u0E22 Gemini AI"),n()(),i(5,"p",134),r(6," \u0E23\u0E30\u0E1A\u0E1A\u0E43\u0E0A\u0E49 AI \u0E02\u0E31\u0E49\u0E19\u0E2A\u0E39\u0E07\u0E08\u0E32\u0E01 Google Gemini \u0E43\u0E19\u0E01\u0E32\u0E23\u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E40\u0E2D\u0E01\u0E2A\u0E32\u0E23 \u0E43\u0E2B\u0E49\u0E04\u0E27\u0E32\u0E21\u0E41\u0E21\u0E48\u0E19\u0E22\u0E33\u0E2A\u0E39\u0E07\u0E01\u0E27\u0E48\u0E32\u0E27\u0E34\u0E18\u0E35\u0E01\u0E32\u0E23\u0E41\u0E1A\u0E1A\u0E40\u0E14\u0E34\u0E21 "),n()())}function ve(o,t){if(o&1&&(i(0,"div",141)(1,"span",137),r(2,"\u0E25\u0E49\u0E21\u0E40\u0E2B\u0E25\u0E27:"),n(),i(3,"span",138),r(4),n()()),o&2){let e=s(3);u(4),E(e.uploadResult.errorCount)}}function he(o,t){if(o&1&&(i(0,"div",135)(1,"div",136)(2,"span",137),r(3,"\u0E17\u0E31\u0E49\u0E07\u0E2B\u0E21\u0E14:"),n(),i(4,"span",138),r(5),n()(),i(6,"div",139)(7,"span",137),r(8,"\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08:"),n(),i(9,"span",138),r(10),n()(),c(11,ve,5,1,"div",140),n()),o&2){let e=s(2);u(5),E(e.uploadResult.totalOrders),u(5),E(e.uploadResult.successCount),u(),d("ngIf",e.uploadResult.errorCount>0)}}function Ce(o,t){if(o&1&&(i(0,"li"),r(1),n()),o&2){let e=t.$implicit;h("success",e.startsWith("\u2713"))("error",e.startsWith("\u2717")),u(),x(" ",e," ")}}function be(o,t){if(o&1&&(i(0,"div",142)(1,"h4"),r(2,"\u0E01\u0E32\u0E23\u0E15\u0E31\u0E14 Stock:"),n(),i(3,"ul"),c(4,Ce,2,5,"li",143),n()()),o&2){let e=s(2);u(4),d("ngForOf",e.uploadMessages)}}function Oe(o,t){if(o&1&&(i(0,"div",122)(1,"div",123)(2,"div",124),c(3,fe,1,0,"i",125)(4,_e,1,0,"i",126),n(),i(5,"div",127)(6,"h3"),r(7),n(),i(8,"p"),r(9),n(),c(10,xe,7,0,"div",128)(11,he,12,3,"div",129)(12,be,5,1,"div",130),n()()()),o&2){let e=s();u(),h("success",e.uploadResult.success)("error",!e.uploadResult.success),u(2),d("ngIf",e.uploadResult.success),u(),d("ngIf",!e.uploadResult.success),u(3),E(e.uploadResult.success?"\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08":"\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E44\u0E21\u0E48\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"),u(2),E(e.uploadResult.message),u(),d("ngIf",e.uploadResult.success&&e.uploadResult.parsedWith==="Gemini AI"),u(),d("ngIf",e.uploadResult.success&&e.uploadType==="shopee"),u(),d("ngIf",e.uploadMessages.length>0)}}var R=class o{constructor(t,e,a){this.orderService=t;this.customerService=e;this.router=a}selectedFile=null;uploadType="24shop";autoDeductStock=!0;uploading=!1;previewMode=!1;isGeminiProcessing=!1;geminiProgress="";orderNumber="";selectedCustomerId=null;customers=[];filteredCustomers=[];searchCustomerTerm="";showCustomerDropdown=!1;uploadResult=null;previewItems=[];previewOrders=[];uploadMessages=[];parsingMethod=null;parsingAccuracy=0;ngOnInit(){this.loadCustomers()}loadCustomers(){this.customerService.getAllCustomers().subscribe({next:t=>{this.customers=t,this.filteredCustomers=t},error:t=>console.error("Error loading customers:",t)})}hideCustomerDropdown(){setTimeout(()=>{this.showCustomerDropdown=!1},200)}onCustomerSearch(){this.searchCustomerTerm.trim()?this.filteredCustomers=this.customers.filter(t=>t.customerName.toLowerCase().includes(this.searchCustomerTerm.toLowerCase())||t.customerPhone&&t.customerPhone.includes(this.searchCustomerTerm)):this.filteredCustomers=this.customers,this.showCustomerDropdown=this.filteredCustomers.length>0}selectCustomer(t){this.selectedCustomerId=t.customerId,this.searchCustomerTerm=t.customerName,this.showCustomerDropdown=!1}onFileSelected(t){let e=t.target.files[0];e&&(this.selectedFile=e,this.uploadResult=null,this.previewItems=[],this.previewOrders=[],this.uploadMessages=[],this.parsingMethod=null,this.parsingAccuracy=0)}onDragOver(t){t.preventDefault(),t.stopPropagation()}onDrop(t){t.preventDefault(),t.stopPropagation(),t.dataTransfer?.files&&t.dataTransfer.files.length>0&&(this.selectedFile=t.dataTransfer.files[0],this.uploadResult=null,this.previewItems=[],this.previewOrders=[],this.parsingMethod=null,this.parsingAccuracy=0)}removeFile(){this.selectedFile=null,this.uploadResult=null,this.previewItems=[],this.previewOrders=[],this.uploadMessages=[],this.parsingMethod=null,this.parsingAccuracy=0}previewFile(){if(!this.selectedFile){alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E44\u0E1F\u0E25\u0E4C");return}this.previewMode=!0,this.uploading=!0,this.uploadType==="24shop"?(this.isGeminiProcessing=!0,this.geminiProgress="\u0E01\u0E33\u0E25\u0E31\u0E07\u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C PDF \u0E14\u0E49\u0E27\u0E22 Gemini AI...",this.orderService.preview24ShopPDF(this.selectedFile).subscribe({next:t=>{this.isGeminiProcessing=!1,t.success?(this.previewItems=t.items||[],this.previewOrders=[],t.parsedWith==="Gemini AI"?(this.parsingMethod="gemini",this.parsingAccuracy=this.calculateAccuracy(this.previewItems),this.geminiProgress=`\u2705 \u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E14\u0E49\u0E27\u0E22 Gemini AI \u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08 (${t.itemsCount} \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23)`):(this.parsingMethod="traditional",this.geminiProgress="\u0E43\u0E0A\u0E49\u0E27\u0E34\u0E18\u0E35\u0E01\u0E32\u0E23\u0E41\u0E1A\u0E1A\u0E40\u0E14\u0E34\u0E21"),this.showSuccessNotification("\u{1F916} Gemini AI \u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08",`\u0E1E\u0E1A ${t.itemsCount} \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32 | \u0E04\u0E27\u0E32\u0E21\u0E41\u0E21\u0E48\u0E19\u0E22\u0E33: ${this.parsingAccuracy}%`)):alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14: "+t.message),this.uploading=!1},error:t=>{console.error("Error previewing file:",t),this.isGeminiProcessing=!1,this.geminiProgress="\u274C \u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14\u0E43\u0E19\u0E01\u0E32\u0E23\u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C",alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14\u0E43\u0E19\u0E01\u0E32\u0E23\u0E41\u0E2A\u0E14\u0E07\u0E15\u0E31\u0E27\u0E2D\u0E22\u0E48\u0E32\u0E07: "+(t.error?.message||t.message)),this.uploading=!1}})):this.orderService.previewExcel(this.selectedFile).subscribe({next:t=>{t.success?(this.previewOrders=t.orders||[],this.previewItems=[],alert(`\u0E41\u0E2A\u0E14\u0E07\u0E15\u0E31\u0E27\u0E2D\u0E22\u0E48\u0E32\u0E07\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08 - \u0E1E\u0E1A ${this.previewOrders.length} \u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C`)):alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14: "+t.message),this.uploading=!1},error:t=>{console.error("Error previewing file:",t),alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14\u0E43\u0E19\u0E01\u0E32\u0E23\u0E41\u0E2A\u0E14\u0E07\u0E15\u0E31\u0E27\u0E2D\u0E22\u0E48\u0E32\u0E07"),this.uploading=!1}})}uploadFile(){this.uploadType==="24shop"?this.upload24Shop():this.uploadShopee()}upload24Shop(){this.validateUpload()&&(this.previewMode=!1,this.uploading=!0,this.uploadMessages=[],this.isGeminiProcessing=!0,this.geminiProgress="\u{1F916} Gemini AI \u0E01\u0E33\u0E25\u0E31\u0E07\u0E1B\u0E23\u0E30\u0E21\u0E27\u0E25\u0E1C\u0E25...",this.orderService.upload24ShopPDFWithCustomer(this.selectedFile,this.orderNumber,this.selectedCustomerId,this.autoDeductStock).subscribe({next:t=>{if(this.isGeminiProcessing=!1,this.uploadResult=t,t.success){t.stockDeductionMessages&&(this.uploadMessages=t.stockDeductionMessages);let e=`\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08!
\u0E40\u0E25\u0E02\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C: ${t.orderNumber}
\u0E08\u0E33\u0E19\u0E27\u0E19\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32: ${t.itemsCount} \u0E23\u0E32\u0E22\u0E01\u0E32\u0E23`;t.parsedWith==="Gemini AI"&&(e+=`

\u{1F916} \u0E1B\u0E23\u0E30\u0E21\u0E27\u0E25\u0E1C\u0E25\u0E14\u0E49\u0E27\u0E22: Gemini AI
\u2728 \u0E04\u0E27\u0E32\u0E21\u0E41\u0E21\u0E48\u0E19\u0E22\u0E33\u0E2A\u0E39\u0E07: ${this.parsingAccuracy}%`,this.geminiProgress="\u2705 Gemini AI \u0E1B\u0E23\u0E30\u0E21\u0E27\u0E25\u0E1C\u0E25\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08"),alert(e),setTimeout(()=>{this.router.navigate(["/orders"])},2e3)}else alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14: "+t.message);this.uploading=!1},error:t=>{console.error("Error uploading file:",t),this.isGeminiProcessing=!1,this.geminiProgress="\u274C \u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14",alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14\u0E43\u0E19\u0E01\u0E32\u0E23\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E44\u0E1F\u0E25\u0E4C: "+(t.error?.message||t.message)),this.uploading=!1}}))}uploadShopee(){if(!this.selectedFile){alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E44\u0E1F\u0E25\u0E4C");return}this.uploading=!0,this.uploadMessages=[],this.orderService.uploadShopeeExcel(this.selectedFile,this.autoDeductStock).subscribe({next:t=>{this.uploadResult=t,t.success?(t.stockDeductionMessages&&(this.uploadMessages=t.stockDeductionMessages),alert(`\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E2A\u0E33\u0E40\u0E23\u0E47\u0E08!
${t.message}`),setTimeout(()=>{this.router.navigate(["/orders"])},2e3)):alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14: "+t.message),this.uploading=!1},error:t=>{console.error("Error uploading file:",t),alert("\u0E40\u0E01\u0E34\u0E14\u0E02\u0E49\u0E2D\u0E1C\u0E34\u0E14\u0E1E\u0E25\u0E32\u0E14\u0E43\u0E19\u0E01\u0E32\u0E23\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E44\u0E1F\u0E25\u0E4C"),this.uploading=!1}})}validateUpload(){if(!this.selectedFile)return alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E44\u0E1F\u0E25\u0E4C"),!1;if(this.uploadType==="24shop"){if(!this.orderNumber.trim())return alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E23\u0E30\u0E1A\u0E38\u0E40\u0E25\u0E02\u0E17\u0E35\u0E48\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C (PO Number)"),!1;if(!this.selectedCustomerId)return alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32"),!1;if(!this.selectedFile.name.toLowerCase().endsWith(".pdf"))return alert("\u0E01\u0E23\u0E38\u0E13\u0E32\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E44\u0E1F\u0E25\u0E4C PDF \u0E2A\u0E33\u0E2B\u0E23\u0E31\u0E1A 24Shop"),!1}return!0}calculateAccuracy(t){if(!t||t.length===0)return 0;let e=0;return t.forEach(a=>{let l=0;a.productSku&&a.productSku.trim()&&(l+=20),a.productName&&a.productName.trim()&&(l+=20),a.quantity>0&&(l+=20),a.unitPrice>0&&(l+=20),a.totalPrice>0&&(l+=20),e+=l}),Math.round(e/t.length)}showSuccessNotification(t,e){console.log(`${t}: ${e}`)}getFileIcon(){if(!this.selectedFile)return"bi-file-earmark";let t=this.selectedFile.name.toLowerCase();return t.endsWith(".pdf")?"bi-file-earmark-pdf":t.endsWith(".xlsx")||t.endsWith(".xls")?"bi-file-earmark-excel":"bi-file-earmark"}formatFileSize(t){return t<1024?t+" B":t<1024*1024?(t/1024).toFixed(2)+" KB":(t/(1024*1024)).toFixed(2)+" MB"}formatCurrency(t){return`\u0E3F${t.toLocaleString("th-TH",{minimumFractionDigits:2,maximumFractionDigits:2})}`}getTotalPreviewAmount(){return this.previewItems.reduce((t,e)=>t+(e.totalPrice||0),0)}goBack(){this.router.navigate(["/orders"])}static \u0275fac=function(e){return new(e||o)(C(N),C(V),C(A))};static \u0275cmp=M({type:o,selectors:[["app-order-upload"]],decls:97,vars:17,consts:[["fileInput",""],[1,"upload-container"],[1,"upload-header"],[1,"back-button",3,"click"],[1,"bi-arrow-left"],[1,"subtitle"],[1,"upload-content"],[1,"upload-type-section"],[1,"type-options"],[1,"type-option",3,"click"],[1,"bi-file-earmark-pdf"],[1,"type-info"],[1,"ai-badge"],[1,"bi-file-earmark-excel"],[1,"traditional-badge"],["class","gemini-status-banner",4,"ngIf"],["class","order-info-section",4,"ngIf"],[1,"file-upload-section"],[1,"upload-area",3,"dragover","drop"],["class","upload-placeholder",4,"ngIf"],["class","file-info",4,"ngIf"],["class","upload-options",4,"ngIf"],["class","upload-actions",4,"ngIf"],["class","preview-section gemini-preview",4,"ngIf"],["class","preview-section",4,"ngIf"],["class","result-section",4,"ngIf"],[1,"instructions-section"],[1,"instruction-cards"],[1,"instruction-card","gemini-card"],[1,"instruction-icon","gemini"],[1,"bi-stars"],[1,"instruction-card"],[1,"instruction-icon"],[1,"bi-box-seam"],[1,"gemini-status-banner"],[1,"gemini-icon"],[1,"gemini-info"],["class","accuracy-meter",4,"ngIf"],[1,"accuracy-meter"],[1,"accuracy-label"],[1,"accuracy-bar"],[1,"accuracy-fill"],[1,"accuracy-value"],[1,"order-info-section"],[1,"order-form-grid"],[1,"form-group"],[1,"required"],["type","text","placeholder","\u0E40\u0E0A\u0E48\u0E19 CT37445675","required","",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-hint"],[1,"form-group",2,"position","relative"],["type","text","placeholder","\u0E04\u0E49\u0E19\u0E2B\u0E32\u0E0A\u0E37\u0E48\u0E2D\u0E2B\u0E23\u0E37\u0E2D\u0E40\u0E1A\u0E2D\u0E23\u0E4C\u0E42\u0E17\u0E23","required","",1,"form-control",3,"ngModelChange","input","focus","blur","ngModel"],["class","form-hint",4,"ngIf"],["class","customer-dropdown",4,"ngIf"],["class","no-customers",4,"ngIf"],[1,"customer-dropdown"],["class","customer-item",3,"mousedown",4,"ngFor","ngForOf"],[1,"customer-item",3,"mousedown"],[1,"customer-name"],["class","customer-phone",4,"ngIf"],[1,"customer-phone"],[1,"no-customers"],[1,"upload-placeholder"],[1,"upload-icon"],[1,"bi-cloud-upload"],["class","bi-stars gemini-star",4,"ngIf"],[4,"ngIf"],["type","file",2,"display","none",3,"change","accept"],[1,"browse-btn",3,"click"],[1,"file-hint"],[1,"bi-stars","gemini-star"],[1,"file-info"],[1,"file-details"],["class","file-meta",4,"ngIf"],[1,"remove-file-btn",3,"click","disabled"],[1,"bi-x"],[1,"file-meta"],[1,"upload-options"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"checkbox-info"],[1,"upload-actions"],[1,"preview-btn",3,"click","disabled"],[1,"bi-eye"],[1,"upload-btn",3,"click","disabled"],["class","loading-spinner",4,"ngIf"],["class","bi-upload",4,"ngIf"],[1,"loading-spinner"],[1,"bi-upload"],[1,"preview-section","gemini-preview"],[1,"preview-header"],[1,"preview-badge","gemini"],[1,"preview-table"],[1,"text-center"],[1,"text-right"],["class","preview-item-row",4,"ngFor","ngForOf"],[1,"total-row"],["colspan","5",1,"text-right"],[1,"total-amount"],[1,"preview-item-row"],[1,"sku-badge"],[1,"product-name-cell"],[1,"quantity-badge"],[1,"status-badge","success"],[1,"bi-check-circle"],[1,"preview-section"],[1,"preview-cards"],["class","preview-card",4,"ngFor","ngForOf"],[1,"preview-card"],[1,"preview-source"],[1,"preview-body"],[1,"preview-row"],[1,"label"],[1,"value"],["class","preview-row",4,"ngIf"],[1,"value","price"],["class","preview-items",4,"ngIf"],[1,"preview-items"],["class","preview-item",4,"ngFor","ngForOf"],[1,"preview-item"],[1,"item-name"],[1,"item-qty"],[1,"item-price"],[1,"result-section"],[1,"result-card"],[1,"result-icon"],["class","bi-check-circle",4,"ngIf"],["class","bi-x-circle",4,"ngIf"],[1,"result-content"],["class","gemini-result-info",4,"ngIf"],["class","result-stats",4,"ngIf"],["class","stock-messages",4,"ngIf"],[1,"bi-x-circle"],[1,"gemini-result-info"],[1,"gemini-badge-large"],[1,"gemini-description"],[1,"result-stats"],[1,"stat-item"],[1,"stat-label"],[1,"stat-value"],[1,"stat-item","success"],["class","stat-item error",4,"ngIf"],[1,"stat-item","error"],[1,"stock-messages"],[3,"success","error",4,"ngFor","ngForOf"]],template:function(e,a){e&1&&(i(0,"div",1)(1,"div",2)(2,"div",3),_("click",function(){return a.goBack()}),m(3,"i",4),r(4," \u0E01\u0E25\u0E31\u0E1A "),n(),i(5,"h1"),r(6,"\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C"),n(),i(7,"p",5),r(8," \u{1F916} \u0E23\u0E2D\u0E07\u0E23\u0E31\u0E1A\u0E01\u0E32\u0E23\u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C\u0E14\u0E49\u0E27\u0E22 Gemini AI - \u0E41\u0E21\u0E48\u0E19\u0E22\u0E33\u0E41\u0E25\u0E30\u0E23\u0E27\u0E14\u0E40\u0E23\u0E47\u0E27\u0E01\u0E27\u0E48\u0E32\u0E40\u0E14\u0E34\u0E21 "),n()(),i(9,"div",6)(10,"div",7)(11,"h3"),r(12,"\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E1B\u0E23\u0E30\u0E40\u0E20\u0E17\u0E44\u0E1F\u0E25\u0E4C"),n(),i(13,"div",8)(14,"div",9),_("click",function(){return a.uploadType="24shop",a.removeFile()}),m(15,"i",10),i(16,"div",11)(17,"h4"),r(18,"24Shop"),n(),i(19,"p"),r(20,"\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E44\u0E1F\u0E25\u0E4C PDF \u0E08\u0E32\u0E01 24Shopping"),n(),i(21,"span",12),r(22,"\u{1F916} Gemini AI"),n()()(),i(23,"div",9),_("click",function(){return a.uploadType="shopee",a.removeFile()}),m(24,"i",13),i(25,"div",11)(26,"h4"),r(27,"Shopee"),n(),i(28,"p"),r(29,"\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14\u0E44\u0E1F\u0E25\u0E4C Excel \u0E08\u0E32\u0E01 Shopee"),n(),i(30,"span",14),r(31,"\u{1F4CA} Excel Parser"),n()()()()(),c(32,$,9,5,"div",15)(33,X,17,5,"div",16),i(34,"div",17)(35,"div",18),_("dragover",function(p){return a.onDragOver(p)})("drop",function(p){return a.onDrop(p)}),c(36,Z,14,5,"div",19)(37,te,10,6,"div",20),n(),c(38,ne,8,1,"div",21)(39,ae,9,7,"div",22),n(),c(40,de,36,3,"div",23)(41,ge,5,1,"div",24)(42,Oe,13,11,"div",25),i(43,"div",26)(44,"h3"),r(45,"\u0E04\u0E33\u0E41\u0E19\u0E30\u0E19\u0E33"),n(),i(46,"div",27)(47,"div",28)(48,"div",29),m(49,"i",30),n(),i(50,"h4"),r(51,"\u{1F916} Gemini AI"),n(),i(52,"ul")(53,"li"),r(54,"\u0E43\u0E0A\u0E49 AI \u0E02\u0E31\u0E49\u0E19\u0E2A\u0E39\u0E07\u0E08\u0E32\u0E01 Google \u0E27\u0E34\u0E40\u0E04\u0E23\u0E32\u0E30\u0E2B\u0E4C PDF"),n(),i(55,"li"),r(56,"\u0E04\u0E27\u0E32\u0E21\u0E41\u0E21\u0E48\u0E19\u0E22\u0E33\u0E2A\u0E39\u0E07\u0E01\u0E27\u0E48\u0E32\u0E27\u0E34\u0E18\u0E35\u0E01\u0E32\u0E23\u0E41\u0E1A\u0E1A\u0E40\u0E14\u0E34\u0E21 95%"),n(),i(57,"li"),r(58,"\u0E23\u0E2D\u0E07\u0E23\u0E31\u0E1A PDF \u0E17\u0E35\u0E48\u0E21\u0E35 layout \u0E0B\u0E31\u0E1A\u0E0B\u0E49\u0E2D\u0E19"),n(),i(59,"li"),r(60,"\u0E1B\u0E23\u0E30\u0E21\u0E27\u0E25\u0E1C\u0E25\u0E40\u0E23\u0E47\u0E27\u0E41\u0E25\u0E30\u0E41\u0E21\u0E48\u0E19\u0E22\u0E33\u0E22\u0E34\u0E48\u0E07\u0E02\u0E36\u0E49\u0E19"),n()()(),i(61,"div",31)(62,"div",32),m(63,"i",10),n(),i(64,"h4"),r(65,"24Shop (PDF)"),n(),i(66,"ul")(67,"li"),r(68,"\u0E43\u0E0A\u0E49\u0E44\u0E1F\u0E25\u0E4C PDF \u0E08\u0E32\u0E01 Purchase Order \u0E02\u0E2D\u0E07 24Shopping"),n(),i(69,"li"),r(70,"\u0E23\u0E30\u0E1A\u0E38\u0E40\u0E25\u0E02 PO \u0E41\u0E25\u0E30\u0E40\u0E25\u0E37\u0E2D\u0E01\u0E25\u0E39\u0E01\u0E04\u0E49\u0E32\u0E01\u0E48\u0E2D\u0E19\u0E2D\u0E31\u0E1E\u0E42\u0E2B\u0E25\u0E14"),n(),i(71,"li"),r(72,"\u0E23\u0E30\u0E1A\u0E1A\u0E08\u0E30\u0E2D\u0E48\u0E32\u0E19\u0E02\u0E49\u0E2D\u0E21\u0E39\u0E25\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32\u0E42\u0E14\u0E22\u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34\u0E14\u0E49\u0E27\u0E22 Gemini"),n()()(),i(73,"div",31)(74,"div",32),m(75,"i",13),n(),i(76,"h4"),r(77,"Shopee (Excel)"),n(),i(78,"ul")(79,"li"),r(80,"\u0E43\u0E0A\u0E49\u0E44\u0E1F\u0E25\u0E4C Excel \u0E17\u0E35\u0E48 Export \u0E08\u0E32\u0E01 Shopee Seller Center"),n(),i(81,"li"),r(82,"\u0E04\u0E27\u0E23\u0E21\u0E35 Column: Order Number, Customer Name, Product, Quantity, Price"),n(),i(83,"li"),r(84,"\u0E23\u0E2D\u0E07\u0E23\u0E31\u0E1A\u0E44\u0E1F\u0E25\u0E4C .xlsx \u0E41\u0E25\u0E30 .xls"),n()()(),i(85,"div",31)(86,"div",32),m(87,"i",33),n(),i(88,"h4"),r(89,"\u0E01\u0E32\u0E23\u0E15\u0E31\u0E14 Stock"),n(),i(90,"ul")(91,"li"),r(92,"\u0E23\u0E30\u0E1A\u0E1A\u0E08\u0E30\u0E15\u0E31\u0E14 Stock \u0E2D\u0E31\u0E15\u0E42\u0E19\u0E21\u0E31\u0E15\u0E34\u0E08\u0E32\u0E01\u0E2A\u0E48\u0E27\u0E19\u0E1B\u0E23\u0E30\u0E01\u0E2D\u0E1A\u0E02\u0E2D\u0E07\u0E2A\u0E34\u0E19\u0E04\u0E49\u0E32"),n(),i(93,"li"),r(94,"\u0E15\u0E49\u0E2D\u0E07\u0E21\u0E35 Product \u0E17\u0E35\u0E48\u0E15\u0E23\u0E07\u0E01\u0E31\u0E1A SKU \u0E43\u0E19\u0E23\u0E30\u0E1A\u0E1A"),n(),i(95,"li"),r(96,"\u0E2A\u0E32\u0E21\u0E32\u0E23\u0E16\u0E15\u0E31\u0E14 Stock \u0E17\u0E35\u0E2B\u0E25\u0E31\u0E07\u0E44\u0E14\u0E49\u0E08\u0E32\u0E01\u0E2B\u0E19\u0E49\u0E32\u0E23\u0E32\u0E22\u0E01\u0E32\u0E23\u0E2D\u0E2D\u0E40\u0E14\u0E2D\u0E23\u0E4C"),n()()()()()()()),e&2&&(u(14),h("active",a.uploadType==="24shop"),u(9),h("active",a.uploadType==="shopee"),u(9),d("ngIf",a.isGeminiProcessing||a.parsingMethod==="gemini"),u(),d("ngIf",a.uploadType==="24shop"),u(2),h("has-file",a.selectedFile)("gemini-active",a.uploadType==="24shop"),u(),d("ngIf",!a.selectedFile),u(),d("ngIf",a.selectedFile),u(),d("ngIf",a.selectedFile),u(),d("ngIf",a.selectedFile),u(),d("ngIf",a.previewItems.length>0&&a.uploadType==="24shop"),u(),d("ngIf",a.previewOrders.length>0&&a.uploadType==="shopee"),u(),d("ngIf",a.uploadResult&&!a.uploading))},dependencies:[k,I,D,G,F,T,U,z,B],styles:[`.gemini-status-banner[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);border-radius:12px;padding:1.5rem;margin-bottom:2rem;display:flex;align-items:center;gap:1.5rem;color:#fff;box-shadow:0 4px 20px #667eea4d;animation:_ngcontent-%COMP%_slideIn .3s ease-out}@keyframes _ngcontent-%COMP%_slideIn{0%{opacity:0;transform:translateY(-20px)}to{opacity:1;transform:translateY(0)}}.gemini-icon[_ngcontent-%COMP%]{font-size:3rem;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}.gemini-icon[_ngcontent-%COMP%]   .spinning[_ngcontent-%COMP%]{animation:_ngcontent-%COMP%_spin 2s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1);opacity:1}50%{transform:scale(1.1);opacity:.8}}.gemini-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .5rem;font-size:1.2rem}.gemini-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;opacity:.9}.accuracy-meter[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-top:1rem;background:#fff3;padding:.75rem;border-radius:8px}.accuracy-label[_ngcontent-%COMP%]{font-weight:600;font-size:.9rem}.accuracy-bar[_ngcontent-%COMP%]{flex:1;height:24px;background:#ffffff4d;border-radius:12px;overflow:hidden;position:relative}.accuracy-fill[_ngcontent-%COMP%]{height:100%;background:linear-gradient(90deg,#48bb78,#38a169);border-radius:12px;transition:width 1s ease-out;display:flex;align-items:center;justify-content:flex-end;padding-right:.5rem}.accuracy-value[_ngcontent-%COMP%]{font-weight:700;font-size:1.1rem;min-width:60px;text-align:right}.ai-badge[_ngcontent-%COMP%]{display:inline-block;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;padding:.25rem .75rem;border-radius:20px;font-size:.75rem;font-weight:600;margin-top:.5rem}.traditional-badge[_ngcontent-%COMP%]{display:inline-block;background:#48bb78;color:#fff;padding:.25rem .75rem;border-radius:20px;font-size:.75rem;font-weight:600;margin-top:.5rem}.upload-area.gemini-active[_ngcontent-%COMP%]{border-color:#667eea;background:linear-gradient(135deg,#667eea0d,#764ba20d)}.upload-area.gemini-active[_ngcontent-%COMP%]:hover{border-color:#764ba2;background:linear-gradient(135deg,#667eea1a,#764ba21a)}.upload-icon[_ngcontent-%COMP%]{position:relative;display:inline-block}.gemini-star[_ngcontent-%COMP%]{position:absolute;top:-10px;right:-10px;font-size:2rem;color:#667eea;animation:_ngcontent-%COMP%_sparkle 1.5s ease-in-out infinite}@keyframes _ngcontent-%COMP%_sparkle{0%,to{transform:scale(1) rotate(0);opacity:1}50%{transform:scale(1.2) rotate(180deg);opacity:.7}}.file-meta[_ngcontent-%COMP%]{display:inline-block;margin-top:.5rem;padding:.35rem .75rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:20px;font-size:.85rem;font-weight:500}.preview-section.gemini-preview[_ngcontent-%COMP%]{border:2px solid #667eea;background:linear-gradient(135deg,#667eea05,#764ba205)}.preview-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem;padding-bottom:1rem;border-bottom:2px solid #f0f0f0}.preview-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;display:flex;align-items:center;gap:.5rem;color:#1a202c}.preview-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#667eea;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}.preview-badge[_ngcontent-%COMP%]{padding:.5rem 1rem;border-radius:20px;font-size:.85rem;font-weight:600}.preview-badge.gemini[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.preview-item-row[_ngcontent-%COMP%]{transition:all .2s ease}.preview-item-row[_ngcontent-%COMP%]:hover{background:#f7fafc;transform:scale(1.005)}.sku-badge[_ngcontent-%COMP%]{display:inline-block;background:#edf2f7;padding:.35rem .75rem;border-radius:6px;font-family:Courier New,monospace;font-weight:600;color:#2d3748;font-size:.85rem}.product-name-cell[_ngcontent-%COMP%]{font-weight:500;color:#2d3748}.quantity-badge[_ngcontent-%COMP%]{display:inline-block;background:#bee3f8;color:#2c5282;padding:.35rem .75rem;border-radius:6px;font-weight:600;font-size:.9rem}.status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.35rem;padding:.35rem .75rem;border-radius:20px;font-size:.85rem;font-weight:500}.status-badge.success[_ngcontent-%COMP%]{background:#c6f6d5;color:#22543d}.total-row[_ngcontent-%COMP%]{background:#f7fafc;font-weight:600;border-top:2px solid #cbd5e0}.total-amount[_ngcontent-%COMP%]{color:#48bb78;font-size:1.2rem}.gemini-result-info[_ngcontent-%COMP%]{margin:1.5rem 0;padding:1.5rem;background:linear-gradient(135deg,#667eea1a,#764ba21a);border-radius:12px;border:2px solid #667eea}.gemini-badge-large[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.75rem;padding:.75rem 1.5rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border-radius:30px;font-size:1rem;font-weight:600;margin-bottom:1rem}.gemini-badge-large[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:1.5rem;animation:_ngcontent-%COMP%_pulse 2s ease-in-out infinite}.gemini-description[_ngcontent-%COMP%]{margin:1rem 0 0;color:#4a5568;line-height:1.6}.instruction-card.gemini-card[_ngcontent-%COMP%]{border:2px solid #667eea;background:linear-gradient(135deg,#667eea0d,#764ba20d)}.instruction-icon.gemini[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2)}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem;cursor:pointer}.checkbox-label[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{margin-top:.25rem;width:20px;height:20px;cursor:pointer}.checkbox-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.25rem}.checkbox-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:600;color:#2d3748}.checkbox-info[_ngcontent-%COMP%]   small[_ngcontent-%COMP%]{color:#718096;font-size:.85rem}.upload-container[_ngcontent-%COMP%]{margin:1rem;padding:1.5rem;background-color:#fff;border-radius:1rem;box-shadow:0 2px 8px #0000000d;border:1px solid #e5e7eb;min-height:calc(100vh - 2rem);font-family:Inter,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,sans-serif;box-sizing:border-box}.upload-header[_ngcontent-%COMP%]{margin-bottom:2rem}.back-button[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem 1rem;background:#fff;border:1px solid #e2e8f0;border-radius:8px;cursor:pointer;color:#4a5568;margin-bottom:1rem;transition:all .2s}.back-button[_ngcontent-%COMP%]:hover{background:#f7fafc;border-color:#cbd5e0}.upload-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:.5rem 0;font-size:2rem;color:#1a202c}.subtitle[_ngcontent-%COMP%]{color:#718096;margin:0}.upload-content[_ngcontent-%COMP%]{max-width:1200px;margin:0 auto}.upload-type-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;margin-bottom:2rem;box-shadow:0 2px 8px #0000000d}.upload-type-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:#1a202c}.type-options[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));gap:1rem}.type-option[_ngcontent-%COMP%]{padding:1.5rem;border:2px solid #e2e8f0;border-radius:12px;display:flex;align-items:flex-start;gap:1rem;cursor:pointer;transition:all .3s}.type-option[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#f7fafc}.type-option.active[_ngcontent-%COMP%]{border-color:#667eea;background:linear-gradient(135deg,#667eea1a,#764ba21a)}.type-option[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:2.5rem;color:#667eea;flex-shrink:0}.type-info[_ngcontent-%COMP%]{flex:1}.type-info[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .25rem;color:#1a202c}.type-info[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#718096;font-size:.9rem}.file-upload-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;margin-bottom:2rem;box-shadow:0 2px 8px #0000000d}.upload-area[_ngcontent-%COMP%]{border:3px dashed #cbd5e0;border-radius:12px;padding:3rem;text-align:center;transition:all .3s;background:#f7fafc}.upload-area[_ngcontent-%COMP%]:hover{border-color:#667eea;background:#667eea0d}.upload-area.has-file[_ngcontent-%COMP%]{border-style:solid;border-color:#48bb78;background:#48bb780d}.upload-placeholder[_ngcontent-%COMP%]   i.bi-cloud-upload[_ngcontent-%COMP%]{font-size:4rem;color:#a0aec0;margin-bottom:1rem}.upload-placeholder[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 .5rem;color:#2d3748}.upload-placeholder[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:#718096}.browse-btn[_ngcontent-%COMP%]{padding:.75rem 2rem;background:#667eea;color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500;transition:all .2s}.browse-btn[_ngcontent-%COMP%]:hover{background:#5a67d8;transform:translateY(-2px)}.file-hint[_ngcontent-%COMP%]{display:block;margin-top:1rem;color:#a0aec0;font-size:.85rem}.file-info[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.file-info[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:3rem;color:#48bb78}.file-details[_ngcontent-%COMP%]{flex:1;text-align:left}.file-details[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 .25rem;color:#2d3748;font-size:1.1rem}.file-details[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:#718096;font-size:.9rem}.remove-file-btn[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;background:#fed7d7;color:#c53030;border:none;cursor:pointer;font-size:1.5rem;display:flex;align-items:center;justify-content:center;transition:all .2s}.remove-file-btn[_ngcontent-%COMP%]:hover{background:#fc8181;color:#fff}.remove-file-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.upload-options[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1.5rem;background:#f7fafc;border-radius:8px}.upload-actions[_ngcontent-%COMP%]{display:flex;gap:1rem;margin-top:1.5rem;justify-content:flex-end}.preview-btn[_ngcontent-%COMP%]{padding:.75rem 1.5rem;background:#fff;color:#667eea;border:2px solid #667eea;border-radius:8px;cursor:pointer;font-weight:500;display:flex;align-items:center;gap:.5rem;transition:all .2s}.preview-btn[_ngcontent-%COMP%]:hover{background:#667eea;color:#fff}.preview-btn[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.upload-btn[_ngcontent-%COMP%]{padding:.75rem 2rem;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:500;display:flex;align-items:center;gap:.5rem;transition:all .2s}.upload-btn[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:0 10px 25px #667eea4d}.upload-btn[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.preview-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;margin-bottom:2rem;box-shadow:0 2px 8px #0000000d}.preview-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:#1a202c}.preview-table[_ngcontent-%COMP%]{overflow-x:auto;margin-top:1rem;background:#fff;border-radius:12px;box-shadow:0 2px 8px #0000001a}.preview-table[_ngcontent-%COMP%]   table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.preview-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background:linear-gradient(135deg,#667eea,#764ba2);color:#fff}.preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:16px;text-align:left;font-weight:600;font-size:14px;text-transform:uppercase;letter-spacing:.5px}.preview-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:14px 16px;border-bottom:1px solid #e9ecef;font-size:14px;color:#495057}.preview-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.preview-table[_ngcontent-%COMP%]   td.text-center[_ngcontent-%COMP%], .preview-table[_ngcontent-%COMP%]   th.text-center[_ngcontent-%COMP%]{text-align:center}.preview-table[_ngcontent-%COMP%]   td.text-right[_ngcontent-%COMP%], .preview-table[_ngcontent-%COMP%]   th.text-right[_ngcontent-%COMP%]{text-align:right}.loading-spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:3px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.order-info-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;margin-bottom:2rem;box-shadow:0 2px 8px #0000000d}.order-info-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:#1a202c;font-size:1.2rem}.order-form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1.5rem}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#4a5568;font-size:.9rem}.form-group[_ngcontent-%COMP%]   label.required[_ngcontent-%COMP%]:after{content:" *";color:#e53e3e}.form-control[_ngcontent-%COMP%]{padding:.75rem;border:2px solid #e2e8f0;border-radius:8px;font-size:.95rem;transition:all .2s}.form-control[_ngcontent-%COMP%]:focus{outline:none;border-color:#667eea;box-shadow:0 0 0 3px #667eea1a}.form-hint[_ngcontent-%COMP%]{color:#a0aec0;font-size:.85rem}.customer-dropdown[_ngcontent-%COMP%]{position:absolute;top:100%;left:0;right:0;background:#fff;border:2px solid #667eea;border-top:none;border-radius:0 0 8px 8px;max-height:200px;overflow-y:auto;z-index:1000;box-shadow:0 4px 12px #0000001a;margin-top:-2px}.customer-item[_ngcontent-%COMP%]{padding:.75rem 1rem;cursor:pointer;display:flex;flex-direction:column;gap:.25rem;border-bottom:1px solid #f0f0f0;transition:background .2s}.customer-item[_ngcontent-%COMP%]:last-child{border-bottom:none}.customer-item[_ngcontent-%COMP%]:hover{background:#f7fafc}.customer-name[_ngcontent-%COMP%]{font-weight:500;color:#2d3748}.customer-phone[_ngcontent-%COMP%]{font-size:.85rem;color:#718096}.instructions-section[_ngcontent-%COMP%]{background:#fff;border-radius:12px;padding:2rem;box-shadow:0 2px 8px #0000000d}.instructions-section[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0 0 1.5rem;color:#1a202c}.instruction-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:1.5rem}.instruction-card[_ngcontent-%COMP%]{padding:1.5rem;border:1px solid #e2e8f0;border-radius:8px;background:#f7fafc}.instruction-icon[_ngcontent-%COMP%]{width:50px;height:50px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:10px;display:flex;align-items:center;justify-content:center;color:#fff;font-size:1.5rem;margin-bottom:1rem}.instruction-card[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{margin:0 0 1rem;color:#2d3748}.instruction-card[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin:0;padding-left:1.5rem}.instruction-card[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{color:#718096;font-size:.9rem;margin-bottom:.5rem}@media (max-width: 768px){.upload-container[_ngcontent-%COMP%]{padding:1rem}.type-options[_ngcontent-%COMP%]{grid-template-columns:1fr}.upload-actions[_ngcontent-%COMP%]{flex-direction:column}.preview-btn[_ngcontent-%COMP%], .upload-btn[_ngcontent-%COMP%]{width:100%;justify-content:center}.instruction-cards[_ngcontent-%COMP%], .order-form-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.gemini-status-banner[_ngcontent-%COMP%]{flex-direction:column;text-align:center}}









`]})};export{R as OrderUploadComponent};
